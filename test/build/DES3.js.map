{"version":3,"sources":["webpack://JsCrypto/webpack/universalModuleDefinition","webpack://JsCrypto/webpack/bootstrap","webpack://JsCrypto/(webpack)/buildin/global.js","webpack://JsCrypto/./src/DES.ts","webpack://JsCrypto/./src/DES3.ts","webpack://JsCrypto/./src/MD5.ts","webpack://JsCrypto/./src/lib/Word32Array.ts","webpack://JsCrypto/./src/lib/algorithm/BufferedBlockAlgorithm.ts","webpack://JsCrypto/./src/lib/algorithm/Hasher.ts","webpack://JsCrypto/./src/lib/algorithm/cipher/BlockCipher.ts","webpack://JsCrypto/./src/lib/algorithm/cipher/Cipher.ts","webpack://JsCrypto/./src/lib/algorithm/cipher/CipherParams.ts","webpack://JsCrypto/./src/lib/algorithm/cipher/PasswordBasedCipher.ts","webpack://JsCrypto/./src/lib/algorithm/cipher/SerializableCipher.ts","webpack://JsCrypto/./src/lib/algorithm/cipher/formatter/OpenSSLFormatter.ts","webpack://JsCrypto/./src/lib/algorithm/cipher/kdf/OpenSSLKDF.ts","webpack://JsCrypto/./src/lib/algorithm/cipher/kdf/module/EvpKDF.ts","webpack://JsCrypto/./src/lib/algorithm/cipher/kdf/type.ts","webpack://JsCrypto/./src/lib/algorithm/cipher/mode/BlockCipherMode.ts","webpack://JsCrypto/./src/lib/algorithm/cipher/mode/ECB.ts","webpack://JsCrypto/./src/lib/algorithm/cipher/pad/Noop.ts","webpack://JsCrypto/./src/lib/encoder/Base64.ts","webpack://JsCrypto/./src/lib/encoder/Hex.ts","webpack://JsCrypto/./src/lib/encoder/Latin1.ts","webpack://JsCrypto/./src/lib/encoder/Utf8.ts","webpack://JsCrypto/./src/lib/random.ts"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;QCVA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;AClFA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;;AAE5C;;;;;;;;;;;;;ACnBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACiE;AACV;AAC0B;AACF;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,kBAAkB,6EAAW;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,QAAQ;AAC/B;AACA;AACA;AACA;AACA;AACA,6BAA6B,cAAc;AAC3C;AACA;AACA;AACA;AACA;AACA,2BAA2B,QAAQ;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,OAAO;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,QAAQ;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,YAAY;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,OAAO;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,YAAY;AAC3B,eAAe,sBAAsB;AACrC,gBAAgB,OAAO;AACvB;AACA,yDAAyD,kBAAkB;AAC3E;AACA;AACA,iDAAiD;AACjD,qDAAqD,WAAW,qBAAqB,mEAAM,qBAAqB;AAChH;AACA;AACA;AACA;AACA,eAAe,YAAY;AAC3B,eAAe,sBAAsB;AACrC,gBAAgB,OAAO;AACvB;AACA,yDAAyD,kBAAkB;AAC3E;AACA;AACA,iDAAiD;AACjD,qDAAqD,WAAW,qBAAqB,mEAAM,qBAAqB;AAChH;AACA;AACA;AACA;AACA,eAAe,mBAAmB;AAClC,eAAe,mBAAmB;AAClC,eAAe,mBAAmB;AAClC;AACA;AACA;AACA;AACA;AACA,mBAAmB,6FAAmB;AACtC;AACA,eAAe,2FAAkB;AACjC;AACA;AACA;AACA;AACA,eAAe,aAAa;AAC5B,eAAe,mBAAmB;AAClC,eAAe,mBAAmB;AAClC;AACA;AACA;AACA;AACA;AACA,mBAAmB,6FAAmB;AACtC;AACA,eAAe,2FAAkB;AACjC;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACttBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+E;AACd;AACV;AAC3B;AACoB;AACiC;AAC1E,mBAAmB,6EAAW;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,wCAAG,qBAAqB,4DAAW;AACxD,qBAAqB,wCAAG,qBAAqB,4DAAW;AACxD,qBAAqB,wCAAG,qBAAqB,4DAAW;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,YAAY;AAC3B,eAAe,sBAAsB;AACrC,gBAAgB,OAAO;AACvB;AACA,0DAA0D,kBAAkB;AAC5E;AACA;AACA,iDAAiD;AACjD,sDAAsD,WAAW,qBAAqB,mEAAM,qBAAqB;AACjH;AACA;AACA;AACA;AACA,eAAe,YAAY;AAC3B,eAAe,sBAAsB;AACrC,gBAAgB,OAAO;AACvB;AACA,0DAA0D,kBAAkB;AAC5E;AACA;AACA,iDAAiD;AACjD,sDAAsD,WAAW,qBAAqB,mEAAM,qBAAqB;AACjH;AACA;AACA;AACA;AACA,eAAe,mBAAmB;AAClC,eAAe,mBAAmB;AAClC,eAAe,mBAAmB;AAClC;AACA;AACA;AACA;AACA;AACA,mBAAmB,6FAAmB;AACtC;AACA,eAAe,2FAAkB;AACjC;AACA;AACA;AACA;AACA,eAAe,aAAa;AAC5B,eAAe,mBAAmB;AAClC,eAAe,mBAAmB;AAClC;AACA;AACA;AACA;AACA;AACA,mBAAmB,6FAAmB;AACtC;AACA,eAAe,2FAAkB;AACjC;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC9GA;AAAA;AAAA;AAAA;AAAgD;AACA;AAChD;AACA;AACA;AACA,mBAAmB,QAAQ;AAC3B;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,kBAAkB,4DAAM;AAC/B;AACA;AACA,yBAAyB,4DAAW;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,4DAAW;AACpC;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,QAAQ;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,OAAO;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACzLA;AAAA;AAAA;AAAA;AAAoC;AACF;AAClC;AACA;AACA;AACO;AACP;AACA;AACA;AACA,eAAe,MAAM;AACrB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,UAAU;AACzB,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,gDAAG;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,YAAY;AAC3B,gBAAgB,YAAY;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,OAAO;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,OAAO;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,YAAY;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,gBAAgB,YAAY;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,YAAY;AACnC,uBAAuB,sDAAM;AAC7B;AACA;AACA;AACA;;;;;;;;;;;;;ACxHA;AAAA;AAAA;AAAA;AAA6C;AACN;AAChC;AACP;AACA;AACA;AACA;AACA,2FAA2F,wDAAW;AACtG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sEAAsE,wDAAW;AACjF;AACA;AACA;AACA;AACA;AACA,eAAe,mBAAmB;AAClC;AACA;AACA;AACA;AACA;AACA,6CAA6C,kDAAI;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAAS;AACxB,gBAAgB,YAAY;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,sBAAsB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,wDAAW;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACnFA;AAAA;AAAA;AAAkE;AAC3D,qBAAqB,8EAAsB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,mBAAmB;AAClC,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,oBAAoB;AACnC,gBAAgB,YAAY;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACvEA;AAAA;AAAA;AAAA;AAAA;AAAkC;AACD;AACC;AAC3B,0BAA0B,8CAAM;AACvC;AACA;AACA;AACA,qBAAqB,6CAAG;AACxB,wBAAwB,8CAAI;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,8CAAM;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,+CAA+C;AACxF;AACA;AACA,uDAAuD,+CAA+C;AACtG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,8CAAM;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,YAAY;AAC3B,eAAe,sBAAsB;AACrC,gBAAgB,OAAO;AACvB;AACA,2DAA2D,kBAAkB;AAC7E;AACA;AACA,iDAAiD;AACjD,6DAA6D,WAAW,qBAAqB,8CAAM,qBAAqB;AACxH;AACA;AACA;AACA,eAAe,YAAY;AAC3B,eAAe,sBAAsB;AACrC,gBAAgB,OAAO;AACvB;AACA,yDAAyD,kBAAkB;AAC3E;AACA;AACA,iDAAiD;AACjD,6DAA6D,WAAW,qBAAqB,8CAAM,qBAAqB;AACxH;AACA;;;;;;;;;;;;;ACnGA;AAAA;AAAA;AAAmE;AAC5D,qBAAqB,8EAAsB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,mBAAmB;AAClC,gBAAgB,YAAY;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,oBAAoB;AACnC,gBAAgB,YAAY;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,YAAY;AAC3B,eAAe,sBAAsB;AACrC,gBAAgB,OAAO;AACvB;AACA,2DAA2D,kBAAkB;AAC7E;AACA;AACA,iDAAiD;AACjD,wDAAwD,WAAW,gDAAgD;AACnH;AACA;AACA;AACA,eAAe,YAAY;AAC3B,eAAe,sBAAsB;AACrC,gBAAgB,OAAO;AACvB;AACA,yDAAyD,kBAAkB;AAC3E;AACA;AACA,iDAAiD;AACjD,wDAAwD,WAAW,gDAAgD;AACnH;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACnGA;AAAA;AAAA;AAAgE;AAChE;AACA;AACA;AACA,cAAc,YAAY;AAC1B,cAAc,YAAY;AAC1B,cAAc,YAAY;AAC1B,cAAc,YAAY;AAC1B,cAAc,cAAc;AAC5B,cAAc,gBAAgB;AAC9B,cAAc,IAAI;AAClB,cAAc,OAAO;AACrB,cAAc,UAAU;AACxB;AACO;AACP;AACA;AACA;AACA,eAAe,sBAAsB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,yBAAyB,4EAAgB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,4EAAgB;AAC7D;AACA;AACA;AACA;AACA;AACA,eAAe,WAAW;AAC1B,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC5DA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA4E;AAC9B;AACA;AACkB;AACzD;AACP;AACA;AACA;AACA,eAAe,cAAc;AAC7B,eAAe,mBAAmB;AAClC,eAAe,OAAO;AACtB,eAAe,mCAAmC;AAClD,gBAAgB,aAAa;AAC7B;AACA;AACA,6EAA6E,2BAA2B;AACxG;AACA;AACA,0CAA0C;AAC1C,qDAAqD,0DAAU;AAC/D;AACA;AACA,6BAA6B,sEAAkB;AAC/C,mBAAmB,0DAAY,+BAA+B,kBAAkB,yEAAyE;AACzJ,KAAK;AACL;AACA;AACA;AACA,eAAe,cAAc;AAC7B,eAAe,oBAAoB;AACnC,eAAe,OAAO;AACtB,eAAe,mCAAmC;AAClD,gBAAgB,YAAY;AAC5B;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA,0CAA0C;AAC1C,oCAAoC,0DAAU;AAC9C,sDAAsD,4EAAgB;AACtE,gCAAgC,2EAAe;AAC/C;AACA;AACA,eAAe,sEAAkB;AACjC;AACA;;;;;;;;;;;;;ACxDA;AAAA;AAAA;AAAA;AAAA;AAAgE;AAClB;AAC9C;AACA;AACA;AACA,WAAW,oBAAoB;AAC/B,WAAW,UAAU;AACrB,YAAY,aAAa;AACzB;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA,eAAe,cAAc;AAC7B,eAAe,mBAAmB;AAClC,eAAe,YAAY;AAC3B,eAAe,kCAAkC;AACjD,gBAAgB,aAAa;AAC7B;AACA;AACA,+EAA+E,SAAS;AACxF;AACA;AACA;AACA;AACA,mBAAmB,0DAAY;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0FAA0F,4EAAgB;AAC1G,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA,eAAe,cAAc;AAC7B,eAAe,oBAAoB;AACnC,eAAe,YAAY;AAC3B,eAAe,iCAAiC;AAChD,gBAAgB,YAAY;AAC5B;AACA,sFAAsF,mCAAmC;AACzH,mFAAmF,mCAAmC;AACtH;AACA;AACA;AACA,iIAAiI,4EAAgB;AACjJ;AACA;AACA;;;;;;;;;;;;;AC7DA;AAAA;AAAA;AAAA;AAAA;AAA+C;AACI;AACF;AAC1C;AACP;AACA;AACA;AACA,eAAe,aAAa;AAC5B,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,wDAAW;AAC7C,sCAAsC,sDAAM;AAC5C;AACA,mCAAmC,sDAAM;AACzC,KAAK;AACL;AACA;AACA;AACA,eAAe,OAAO;AACtB,gBAAgB,aAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,sDAAM;AACjC;AACA;AACA;AACA;AACA;AACA,uBAAuB,wDAAW;AAClC;AACA;AACA;AACA;AACA,mBAAmB,0DAAY,EAAE,mBAAmB;AACpD;AACA;;;;;;;;;;;;;AClDA;AAAA;AAAA;AAAA;AAAA;AAAmD;AACJ;AACN;AACzC;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,aAAa;AACxB,YAAY,aAAa;AACzB;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA,mBAAmB,wDAAW;AAC9B;AACA,gDAAgD,qDAAM;AACtD,kCAAkC,qDAAqD;AACvF;AACA,mFAAmF,cAAc,4BAA4B;AAC7H;AACA,uBAAuB,wDAAW;AAClC;AACA;AACA,mBAAmB,0DAAY,EAAE,gBAAgB;AACjD;AACA;;;;;;;;;;;;;AC/BA;AAAA;AAAA;AAAA;AAAA;AAAyC;AACa;AACd;AACxC;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;AACO,qBAAqB,mDAAa;AACzC;AACA;AACA;AACA,uBAAuB,wCAAG;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,mBAAmB;AAClC,eAAe,mBAAmB;AAClC,gBAAgB,YAAY;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,wDAAW;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,gBAAgB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,mBAAmB;AAClC,eAAe,mBAAmB;AAClC,eAAe,sBAAsB;AACrC,gBAAgB,YAAY;AAC5B;AACA;AACA;AACA;AACA,oDAAoD,aAAa;AACjE,oDAAoD,+BAA+B;AACnF;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC7EA;AAAA;AAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACVA;AAAA;AAAA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,qBAAqB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,qBAAqB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACpCA;AAAA;AAAA;AAAoD;AACpD;AACA;AACA;AACO,kBAAkB,gEAAe;AACxC;AACA;AACA;AACA;AACA;AACA,eAAe,qBAAqB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,qBAAqB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAAS;AACxB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAAS;AACxB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC1DA;AAAA;AAAA;AACA;AACA;AACA,WAAW,YAAY;AACvB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,YAAY;AACvB;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;;;;;;;;;;;;;ACxBA;AAAA;AAAA;AAA6C;AAC7C;AACA;AACA,eAAe,gBAAgB;AAC/B;AACA;AACO;AACP;AACA;AACA;AACA,eAAe,YAAY;AAC3B,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,cAAc;AACrC;AACA;AACA;AACA;AACA,2BAA2B,sCAAsC;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,eAAe,OAAO;AACtB,gBAAgB,YAAY;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,qBAAqB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,wDAAW;AAC9B;AACA;;;;;;;;;;;;;ACxEA;AAAA;AAAA;AAA6C;AACtC;AACP;AACA;AACA;AACA,eAAe,YAAY;AAC3B,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,UAAU;AACjC;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,eAAe,OAAO;AACtB,gBAAgB,YAAY;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,SAAS;AAChC;AACA;AACA,mBAAmB,wDAAW;AAC9B;AACA;;;;;;;;;;;;;ACrCA;AAAA;AAAA;AAA6C;AACtC;AACP;AACA;AACA;AACA,eAAe,YAAY;AAC3B,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,UAAU;AACjC;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,eAAe,OAAO;AACtB,gBAAgB,YAAY;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,SAAS;AAChC;AACA;AACA,mBAAmB,wDAAW;AAC9B;AACA;;;;;;;;;;;;;ACpCA;AAAA;AAAA;AAAkC;AAC3B;AACP;AACA;AACA;AACA,eAAe,YAAY;AAC3B,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA,6CAA6C,8CAAM;AACnD;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,eAAe,OAAO;AACtB,gBAAgB,YAAY;AAC5B;AACA;AACA;AACA;AACA,eAAe,8CAAM;AACrB;AACA;;;;;;;;;;;;;AC7BA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,IAA6B;AAC1C;AACA;AACA;AACA,mBAAmB,OAAuB;AAC1C;AACA;AACA;AACA;AACO","file":"DES3.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"JsCrypto\"] = factory();\n\telse\n\t\troot[\"JsCrypto\"] = factory();\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/DES3.ts\");\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","// Permuted Choice 1 constants\r\nimport { BlockCipher } from \"./lib/algorithm/cipher/BlockCipher\";\r\nimport { Cipher } from \"./lib/algorithm/cipher/Cipher\";\r\nimport { PasswordBasedCipher } from \"./lib/algorithm/cipher/PasswordBasedCipher\";\r\nimport { SerializableCipher } from \"./lib/algorithm/cipher/SerializableCipher\";\r\nconst PC1 = [\r\n    57, 49, 41, 33, 25, 17, 9, 1,\r\n    58, 50, 42, 34, 26, 18, 10, 2,\r\n    59, 51, 43, 35, 27, 19, 11, 3,\r\n    60, 52, 44, 36, 63, 55, 47, 39,\r\n    31, 23, 15, 7, 62, 54, 46, 38,\r\n    30, 22, 14, 6, 61, 53, 45, 37,\r\n    29, 21, 13, 5, 28, 20, 12, 4\r\n];\r\n// Permuted Choice 2 constants\r\nconst PC2 = [\r\n    14, 17, 11, 24, 1, 5,\r\n    3, 28, 15, 6, 21, 10,\r\n    23, 19, 12, 4, 26, 8,\r\n    16, 7, 27, 20, 13, 2,\r\n    41, 52, 31, 37, 47, 55,\r\n    30, 40, 51, 45, 33, 48,\r\n    44, 49, 39, 56, 34, 53,\r\n    46, 42, 50, 36, 29, 32\r\n];\r\n// Cumulative bit shift constants\r\nconst BIT_SHIFTS = [1, 2, 4, 6, 8, 10, 12, 14, 15, 17, 19, 21, 23, 25, 27, 28];\r\n// SBOXes and round permutation constants\r\nconst SBOX_P = [\r\n    {\r\n        0x0: 0x808200,\r\n        0x10000000: 0x8000,\r\n        0x20000000: 0x808002,\r\n        0x30000000: 0x2,\r\n        0x40000000: 0x200,\r\n        0x50000000: 0x808202,\r\n        0x60000000: 0x800202,\r\n        0x70000000: 0x800000,\r\n        0x80000000: 0x202,\r\n        0x90000000: 0x800200,\r\n        0xa0000000: 0x8200,\r\n        0xb0000000: 0x808000,\r\n        0xc0000000: 0x8002,\r\n        0xd0000000: 0x800002,\r\n        0xe0000000: 0x0,\r\n        0xf0000000: 0x8202,\r\n        0x8000000: 0x0,\r\n        0x18000000: 0x808202,\r\n        0x28000000: 0x8202,\r\n        0x38000000: 0x8000,\r\n        0x48000000: 0x808200,\r\n        0x58000000: 0x200,\r\n        0x68000000: 0x808002,\r\n        0x78000000: 0x2,\r\n        0x88000000: 0x800200,\r\n        0x98000000: 0x8200,\r\n        0xa8000000: 0x808000,\r\n        0xb8000000: 0x800202,\r\n        0xc8000000: 0x800002,\r\n        0xd8000000: 0x8002,\r\n        0xe8000000: 0x202,\r\n        0xf8000000: 0x800000,\r\n        0x1: 0x8000,\r\n        0x10000001: 0x2,\r\n        0x20000001: 0x808200,\r\n        0x30000001: 0x800000,\r\n        0x40000001: 0x808002,\r\n        0x50000001: 0x8200,\r\n        0x60000001: 0x200,\r\n        0x70000001: 0x800202,\r\n        0x80000001: 0x808202,\r\n        0x90000001: 0x808000,\r\n        0xa0000001: 0x800002,\r\n        0xb0000001: 0x8202,\r\n        0xc0000001: 0x202,\r\n        0xd0000001: 0x800200,\r\n        0xe0000001: 0x8002,\r\n        0xf0000001: 0x0,\r\n        0x8000001: 0x808202,\r\n        0x18000001: 0x808000,\r\n        0x28000001: 0x800000,\r\n        0x38000001: 0x200,\r\n        0x48000001: 0x8000,\r\n        0x58000001: 0x800002,\r\n        0x68000001: 0x2,\r\n        0x78000001: 0x8202,\r\n        0x88000001: 0x8002,\r\n        0x98000001: 0x800202,\r\n        0xa8000001: 0x202,\r\n        0xb8000001: 0x808200,\r\n        0xc8000001: 0x800200,\r\n        0xd8000001: 0x0,\r\n        0xe8000001: 0x8200,\r\n        0xf8000001: 0x808002\r\n    },\r\n    {\r\n        0x0: 0x40084010,\r\n        0x1000000: 0x4000,\r\n        0x2000000: 0x80000,\r\n        0x3000000: 0x40080010,\r\n        0x4000000: 0x40000010,\r\n        0x5000000: 0x40084000,\r\n        0x6000000: 0x40004000,\r\n        0x7000000: 0x10,\r\n        0x8000000: 0x84000,\r\n        0x9000000: 0x40004010,\r\n        0xa000000: 0x40000000,\r\n        0xb000000: 0x84010,\r\n        0xc000000: 0x80010,\r\n        0xd000000: 0x0,\r\n        0xe000000: 0x4010,\r\n        0xf000000: 0x40080000,\r\n        0x800000: 0x40004000,\r\n        0x1800000: 0x84010,\r\n        0x2800000: 0x10,\r\n        0x3800000: 0x40004010,\r\n        0x4800000: 0x40084010,\r\n        0x5800000: 0x40000000,\r\n        0x6800000: 0x80000,\r\n        0x7800000: 0x40080010,\r\n        0x8800000: 0x80010,\r\n        0x9800000: 0x0,\r\n        0xa800000: 0x4000,\r\n        0xb800000: 0x40080000,\r\n        0xc800000: 0x40000010,\r\n        0xd800000: 0x84000,\r\n        0xe800000: 0x40084000,\r\n        0xf800000: 0x4010,\r\n        0x10000000: 0x0,\r\n        0x11000000: 0x40080010,\r\n        0x12000000: 0x40004010,\r\n        0x13000000: 0x40084000,\r\n        0x14000000: 0x40080000,\r\n        0x15000000: 0x10,\r\n        0x16000000: 0x84010,\r\n        0x17000000: 0x4000,\r\n        0x18000000: 0x4010,\r\n        0x19000000: 0x80000,\r\n        0x1a000000: 0x80010,\r\n        0x1b000000: 0x40000010,\r\n        0x1c000000: 0x84000,\r\n        0x1d000000: 0x40004000,\r\n        0x1e000000: 0x40000000,\r\n        0x1f000000: 0x40084010,\r\n        0x10800000: 0x84010,\r\n        0x11800000: 0x80000,\r\n        0x12800000: 0x40080000,\r\n        0x13800000: 0x4000,\r\n        0x14800000: 0x40004000,\r\n        0x15800000: 0x40084010,\r\n        0x16800000: 0x10,\r\n        0x17800000: 0x40000000,\r\n        0x18800000: 0x40084000,\r\n        0x19800000: 0x40000010,\r\n        0x1a800000: 0x40004010,\r\n        0x1b800000: 0x80010,\r\n        0x1c800000: 0x0,\r\n        0x1d800000: 0x4010,\r\n        0x1e800000: 0x40080010,\r\n        0x1f800000: 0x84000\r\n    },\r\n    {\r\n        0x0: 0x104,\r\n        0x100000: 0x0,\r\n        0x200000: 0x4000100,\r\n        0x300000: 0x10104,\r\n        0x400000: 0x10004,\r\n        0x500000: 0x4000004,\r\n        0x600000: 0x4010104,\r\n        0x700000: 0x4010000,\r\n        0x800000: 0x4000000,\r\n        0x900000: 0x4010100,\r\n        0xa00000: 0x10100,\r\n        0xb00000: 0x4010004,\r\n        0xc00000: 0x4000104,\r\n        0xd00000: 0x10000,\r\n        0xe00000: 0x4,\r\n        0xf00000: 0x100,\r\n        0x80000: 0x4010100,\r\n        0x180000: 0x4010004,\r\n        0x280000: 0x0,\r\n        0x380000: 0x4000100,\r\n        0x480000: 0x4000004,\r\n        0x580000: 0x10000,\r\n        0x680000: 0x10004,\r\n        0x780000: 0x104,\r\n        0x880000: 0x4,\r\n        0x980000: 0x100,\r\n        0xa80000: 0x4010000,\r\n        0xb80000: 0x10104,\r\n        0xc80000: 0x10100,\r\n        0xd80000: 0x4000104,\r\n        0xe80000: 0x4010104,\r\n        0xf80000: 0x4000000,\r\n        0x1000000: 0x4010100,\r\n        0x1100000: 0x10004,\r\n        0x1200000: 0x10000,\r\n        0x1300000: 0x4000100,\r\n        0x1400000: 0x100,\r\n        0x1500000: 0x4010104,\r\n        0x1600000: 0x4000004,\r\n        0x1700000: 0x0,\r\n        0x1800000: 0x4000104,\r\n        0x1900000: 0x4000000,\r\n        0x1a00000: 0x4,\r\n        0x1b00000: 0x10100,\r\n        0x1c00000: 0x4010000,\r\n        0x1d00000: 0x104,\r\n        0x1e00000: 0x10104,\r\n        0x1f00000: 0x4010004,\r\n        0x1080000: 0x4000000,\r\n        0x1180000: 0x104,\r\n        0x1280000: 0x4010100,\r\n        0x1380000: 0x0,\r\n        0x1480000: 0x10004,\r\n        0x1580000: 0x4000100,\r\n        0x1680000: 0x100,\r\n        0x1780000: 0x4010004,\r\n        0x1880000: 0x10000,\r\n        0x1980000: 0x4010104,\r\n        0x1a80000: 0x10104,\r\n        0x1b80000: 0x4000004,\r\n        0x1c80000: 0x4000104,\r\n        0x1d80000: 0x4010000,\r\n        0x1e80000: 0x4,\r\n        0x1f80000: 0x10100\r\n    },\r\n    {\r\n        0x0: 0x80401000,\r\n        0x10000: 0x80001040,\r\n        0x20000: 0x401040,\r\n        0x30000: 0x80400000,\r\n        0x40000: 0x0,\r\n        0x50000: 0x401000,\r\n        0x60000: 0x80000040,\r\n        0x70000: 0x400040,\r\n        0x80000: 0x80000000,\r\n        0x90000: 0x400000,\r\n        0xa0000: 0x40,\r\n        0xb0000: 0x80001000,\r\n        0xc0000: 0x80400040,\r\n        0xd0000: 0x1040,\r\n        0xe0000: 0x1000,\r\n        0xf0000: 0x80401040,\r\n        0x8000: 0x80001040,\r\n        0x18000: 0x40,\r\n        0x28000: 0x80400040,\r\n        0x38000: 0x80001000,\r\n        0x48000: 0x401000,\r\n        0x58000: 0x80401040,\r\n        0x68000: 0x0,\r\n        0x78000: 0x80400000,\r\n        0x88000: 0x1000,\r\n        0x98000: 0x80401000,\r\n        0xa8000: 0x400000,\r\n        0xb8000: 0x1040,\r\n        0xc8000: 0x80000000,\r\n        0xd8000: 0x400040,\r\n        0xe8000: 0x401040,\r\n        0xf8000: 0x80000040,\r\n        0x100000: 0x400040,\r\n        0x110000: 0x401000,\r\n        0x120000: 0x80000040,\r\n        0x130000: 0x0,\r\n        0x140000: 0x1040,\r\n        0x150000: 0x80400040,\r\n        0x160000: 0x80401000,\r\n        0x170000: 0x80001040,\r\n        0x180000: 0x80401040,\r\n        0x190000: 0x80000000,\r\n        0x1a0000: 0x80400000,\r\n        0x1b0000: 0x401040,\r\n        0x1c0000: 0x80001000,\r\n        0x1d0000: 0x400000,\r\n        0x1e0000: 0x40,\r\n        0x1f0000: 0x1000,\r\n        0x108000: 0x80400000,\r\n        0x118000: 0x80401040,\r\n        0x128000: 0x0,\r\n        0x138000: 0x401000,\r\n        0x148000: 0x400040,\r\n        0x158000: 0x80000000,\r\n        0x168000: 0x80001040,\r\n        0x178000: 0x40,\r\n        0x188000: 0x80000040,\r\n        0x198000: 0x1000,\r\n        0x1a8000: 0x80001000,\r\n        0x1b8000: 0x80400040,\r\n        0x1c8000: 0x1040,\r\n        0x1d8000: 0x80401000,\r\n        0x1e8000: 0x400000,\r\n        0x1f8000: 0x401040\r\n    },\r\n    {\r\n        0x0: 0x80,\r\n        0x1000: 0x1040000,\r\n        0x2000: 0x40000,\r\n        0x3000: 0x20000000,\r\n        0x4000: 0x20040080,\r\n        0x5000: 0x1000080,\r\n        0x6000: 0x21000080,\r\n        0x7000: 0x40080,\r\n        0x8000: 0x1000000,\r\n        0x9000: 0x20040000,\r\n        0xa000: 0x20000080,\r\n        0xb000: 0x21040080,\r\n        0xc000: 0x21040000,\r\n        0xd000: 0x0,\r\n        0xe000: 0x1040080,\r\n        0xf000: 0x21000000,\r\n        0x800: 0x1040080,\r\n        0x1800: 0x21000080,\r\n        0x2800: 0x80,\r\n        0x3800: 0x1040000,\r\n        0x4800: 0x40000,\r\n        0x5800: 0x20040080,\r\n        0x6800: 0x21040000,\r\n        0x7800: 0x20000000,\r\n        0x8800: 0x20040000,\r\n        0x9800: 0x0,\r\n        0xa800: 0x21040080,\r\n        0xb800: 0x1000080,\r\n        0xc800: 0x20000080,\r\n        0xd800: 0x21000000,\r\n        0xe800: 0x1000000,\r\n        0xf800: 0x40080,\r\n        0x10000: 0x40000,\r\n        0x11000: 0x80,\r\n        0x12000: 0x20000000,\r\n        0x13000: 0x21000080,\r\n        0x14000: 0x1000080,\r\n        0x15000: 0x21040000,\r\n        0x16000: 0x20040080,\r\n        0x17000: 0x1000000,\r\n        0x18000: 0x21040080,\r\n        0x19000: 0x21000000,\r\n        0x1a000: 0x1040000,\r\n        0x1b000: 0x20040000,\r\n        0x1c000: 0x40080,\r\n        0x1d000: 0x20000080,\r\n        0x1e000: 0x0,\r\n        0x1f000: 0x1040080,\r\n        0x10800: 0x21000080,\r\n        0x11800: 0x1000000,\r\n        0x12800: 0x1040000,\r\n        0x13800: 0x20040080,\r\n        0x14800: 0x20000000,\r\n        0x15800: 0x1040080,\r\n        0x16800: 0x80,\r\n        0x17800: 0x21040000,\r\n        0x18800: 0x40080,\r\n        0x19800: 0x21040080,\r\n        0x1a800: 0x0,\r\n        0x1b800: 0x21000000,\r\n        0x1c800: 0x1000080,\r\n        0x1d800: 0x40000,\r\n        0x1e800: 0x20040000,\r\n        0x1f800: 0x20000080\r\n    },\r\n    {\r\n        0x0: 0x10000008,\r\n        0x100: 0x2000,\r\n        0x200: 0x10200000,\r\n        0x300: 0x10202008,\r\n        0x400: 0x10002000,\r\n        0x500: 0x200000,\r\n        0x600: 0x200008,\r\n        0x700: 0x10000000,\r\n        0x800: 0x0,\r\n        0x900: 0x10002008,\r\n        0xa00: 0x202000,\r\n        0xb00: 0x8,\r\n        0xc00: 0x10200008,\r\n        0xd00: 0x202008,\r\n        0xe00: 0x2008,\r\n        0xf00: 0x10202000,\r\n        0x80: 0x10200000,\r\n        0x180: 0x10202008,\r\n        0x280: 0x8,\r\n        0x380: 0x200000,\r\n        0x480: 0x202008,\r\n        0x580: 0x10000008,\r\n        0x680: 0x10002000,\r\n        0x780: 0x2008,\r\n        0x880: 0x200008,\r\n        0x980: 0x2000,\r\n        0xa80: 0x10002008,\r\n        0xb80: 0x10200008,\r\n        0xc80: 0x0,\r\n        0xd80: 0x10202000,\r\n        0xe80: 0x202000,\r\n        0xf80: 0x10000000,\r\n        0x1000: 0x10002000,\r\n        0x1100: 0x10200008,\r\n        0x1200: 0x10202008,\r\n        0x1300: 0x2008,\r\n        0x1400: 0x200000,\r\n        0x1500: 0x10000000,\r\n        0x1600: 0x10000008,\r\n        0x1700: 0x202000,\r\n        0x1800: 0x202008,\r\n        0x1900: 0x0,\r\n        0x1a00: 0x8,\r\n        0x1b00: 0x10200000,\r\n        0x1c00: 0x2000,\r\n        0x1d00: 0x10002008,\r\n        0x1e00: 0x10202000,\r\n        0x1f00: 0x200008,\r\n        0x1080: 0x8,\r\n        0x1180: 0x202000,\r\n        0x1280: 0x200000,\r\n        0x1380: 0x10000008,\r\n        0x1480: 0x10002000,\r\n        0x1580: 0x2008,\r\n        0x1680: 0x10202008,\r\n        0x1780: 0x10200000,\r\n        0x1880: 0x10202000,\r\n        0x1980: 0x10200008,\r\n        0x1a80: 0x2000,\r\n        0x1b80: 0x202008,\r\n        0x1c80: 0x200008,\r\n        0x1d80: 0x0,\r\n        0x1e80: 0x10000000,\r\n        0x1f80: 0x10002008\r\n    },\r\n    {\r\n        0x0: 0x100000,\r\n        0x10: 0x2000401,\r\n        0x20: 0x400,\r\n        0x30: 0x100401,\r\n        0x40: 0x2100401,\r\n        0x50: 0x0,\r\n        0x60: 0x1,\r\n        0x70: 0x2100001,\r\n        0x80: 0x2000400,\r\n        0x90: 0x100001,\r\n        0xa0: 0x2000001,\r\n        0xb0: 0x2100400,\r\n        0xc0: 0x2100000,\r\n        0xd0: 0x401,\r\n        0xe0: 0x100400,\r\n        0xf0: 0x2000000,\r\n        0x8: 0x2100001,\r\n        0x18: 0x0,\r\n        0x28: 0x2000401,\r\n        0x38: 0x2100400,\r\n        0x48: 0x100000,\r\n        0x58: 0x2000001,\r\n        0x68: 0x2000000,\r\n        0x78: 0x401,\r\n        0x88: 0x100401,\r\n        0x98: 0x2000400,\r\n        0xa8: 0x2100000,\r\n        0xb8: 0x100001,\r\n        0xc8: 0x400,\r\n        0xd8: 0x2100401,\r\n        0xe8: 0x1,\r\n        0xf8: 0x100400,\r\n        0x100: 0x2000000,\r\n        0x110: 0x100000,\r\n        0x120: 0x2000401,\r\n        0x130: 0x2100001,\r\n        0x140: 0x100001,\r\n        0x150: 0x2000400,\r\n        0x160: 0x2100400,\r\n        0x170: 0x100401,\r\n        0x180: 0x401,\r\n        0x190: 0x2100401,\r\n        0x1a0: 0x100400,\r\n        0x1b0: 0x1,\r\n        0x1c0: 0x0,\r\n        0x1d0: 0x2100000,\r\n        0x1e0: 0x2000001,\r\n        0x1f0: 0x400,\r\n        0x108: 0x100400,\r\n        0x118: 0x2000401,\r\n        0x128: 0x2100001,\r\n        0x138: 0x1,\r\n        0x148: 0x2000000,\r\n        0x158: 0x100000,\r\n        0x168: 0x401,\r\n        0x178: 0x2100400,\r\n        0x188: 0x2000001,\r\n        0x198: 0x2100000,\r\n        0x1a8: 0x0,\r\n        0x1b8: 0x2100401,\r\n        0x1c8: 0x100401,\r\n        0x1d8: 0x400,\r\n        0x1e8: 0x2000400,\r\n        0x1f8: 0x100001\r\n    },\r\n    {\r\n        0x0: 0x8000820,\r\n        0x1: 0x20000,\r\n        0x2: 0x8000000,\r\n        0x3: 0x20,\r\n        0x4: 0x20020,\r\n        0x5: 0x8020820,\r\n        0x6: 0x8020800,\r\n        0x7: 0x800,\r\n        0x8: 0x8020000,\r\n        0x9: 0x8000800,\r\n        0xa: 0x20800,\r\n        0xb: 0x8020020,\r\n        0xc: 0x820,\r\n        0xd: 0x0,\r\n        0xe: 0x8000020,\r\n        0xf: 0x20820,\r\n        0x80000000: 0x800,\r\n        0x80000001: 0x8020820,\r\n        0x80000002: 0x8000820,\r\n        0x80000003: 0x8000000,\r\n        0x80000004: 0x8020000,\r\n        0x80000005: 0x20800,\r\n        0x80000006: 0x20820,\r\n        0x80000007: 0x20,\r\n        0x80000008: 0x8000020,\r\n        0x80000009: 0x820,\r\n        0x8000000a: 0x20020,\r\n        0x8000000b: 0x8020800,\r\n        0x8000000c: 0x0,\r\n        0x8000000d: 0x8020020,\r\n        0x8000000e: 0x8000800,\r\n        0x8000000f: 0x20000,\r\n        0x10: 0x20820,\r\n        0x11: 0x8020800,\r\n        0x12: 0x20,\r\n        0x13: 0x800,\r\n        0x14: 0x8000800,\r\n        0x15: 0x8000020,\r\n        0x16: 0x8020020,\r\n        0x17: 0x20000,\r\n        0x18: 0x0,\r\n        0x19: 0x20020,\r\n        0x1a: 0x8020000,\r\n        0x1b: 0x8000820,\r\n        0x1c: 0x8020820,\r\n        0x1d: 0x20800,\r\n        0x1e: 0x820,\r\n        0x1f: 0x8000000,\r\n        0x80000010: 0x20000,\r\n        0x80000011: 0x800,\r\n        0x80000012: 0x8020020,\r\n        0x80000013: 0x20820,\r\n        0x80000014: 0x20,\r\n        0x80000015: 0x8020000,\r\n        0x80000016: 0x8000000,\r\n        0x80000017: 0x8000820,\r\n        0x80000018: 0x8020820,\r\n        0x80000019: 0x8000020,\r\n        0x8000001a: 0x8000800,\r\n        0x8000001b: 0x0,\r\n        0x8000001c: 0x20800,\r\n        0x8000001d: 0x820,\r\n        0x8000001e: 0x20020,\r\n        0x8000001f: 0x8020800\r\n    }\r\n];\r\n// Masks that select the SBOX input\r\nconst SBOX_MASK = [\r\n    0xf8000001, 0x1f800000, 0x01f80000, 0x001f8000,\r\n    0x0001f800, 0x00001f80, 0x000001f8, 0x8000001f\r\n];\r\nexport class DES extends BlockCipher {\r\n    constructor(props) {\r\n        super(props);\r\n        this._subKeys = [];\r\n        this._invSubKeys = [];\r\n        this._lBlock = 0;\r\n        this._rBlock = 0;\r\n        this._props = props;\r\n        this._doReset();\r\n    }\r\n    _doReset() {\r\n        // Shortcuts\r\n        const key = this._key;\r\n        const keyWords = key.words;\r\n        // Select 56 bits according to PC1\r\n        const keyBits = [];\r\n        for (let i = 0; i < 56; i++) {\r\n            const keyBitPos = PC1[i] - 1;\r\n            keyBits[i] = (keyWords[keyBitPos >>> 5] >>> (31 - keyBitPos % 32)) & 1;\r\n        }\r\n        // Assemble 16 subkeys\r\n        const subKeys = this._subKeys = [];\r\n        for (let nSubKey = 0; nSubKey < 16; nSubKey++) {\r\n            // Create subkey\r\n            const subKey = subKeys[nSubKey] = [];\r\n            // Shortcut\r\n            const bitShift = BIT_SHIFTS[nSubKey];\r\n            // Select 48 bits according to PC2\r\n            for (let i = 0; i < 24; i++) {\r\n                // Select from the left 28 key bits\r\n                subKey[(i / 6) | 0] |= keyBits[((PC2[i] - 1) + bitShift) % 28] << (31 - i % 6);\r\n                // Select from the right 28 key bits\r\n                subKey[4 + ((i / 6) | 0)] |= keyBits[28 + (((PC2[i + 24] - 1) + bitShift) % 28)] << (31 - i % 6);\r\n            }\r\n            // Since each subkey is applied to an expanded 32-bit input,\r\n            // the subkey can be broken into 8 values scaled to 32-bits,\r\n            // which allows the key to be used without expansion\r\n            subKey[0] = (subKey[0] << 1) | (subKey[0] >>> 31);\r\n            for (let i = 1; i < 7; i++) {\r\n                subKey[i] = subKey[i] >>> ((i - 1) * 4 + 3);\r\n            }\r\n            subKey[7] = (subKey[7] << 5) | (subKey[7] >>> 27);\r\n        }\r\n        // Compute inverse subkeys\r\n        this._invSubKeys = [];\r\n        for (let i = 0; i < 16; i++) {\r\n            this._invSubKeys[i] = subKeys[15 - i];\r\n        }\r\n    }\r\n    encryptBlock(words, offset) {\r\n        this._doCryptoBlock(words, offset, this._subKeys);\r\n    }\r\n    decryptBlock(words, offset) {\r\n        this._doCryptoBlock(words, offset, this._invSubKeys);\r\n    }\r\n    _doCryptoBlock(words, offset, subKeys) {\r\n        // Get input\r\n        this._lBlock = words[offset];\r\n        this._rBlock = words[offset + 1];\r\n        // Initial permutation\r\n        this._exchangeLR(4, 0x0f0f0f0f);\r\n        this._exchangeLR(16, 0x0000ffff);\r\n        this._exchangeRL(2, 0x33333333);\r\n        this._exchangeRL(8, 0x00ff00ff);\r\n        this._exchangeLR(1, 0x55555555);\r\n        // Rounds\r\n        for (let round = 0; round < 16; round++) {\r\n            // Shortcuts\r\n            const subKey = subKeys[round];\r\n            const lBlock = this._lBlock;\r\n            const rBlock = this._rBlock;\r\n            // Feistel function\r\n            let f = 0;\r\n            for (let i = 0; i < 8; i++) {\r\n                const s = ((rBlock ^ subKey[i]) & SBOX_MASK[i]);\r\n                f |= SBOX_P[i][s >>> 0];\r\n            }\r\n            this._lBlock = rBlock;\r\n            this._rBlock = lBlock ^ f;\r\n        }\r\n        // Undo swap from last round\r\n        const t = this._lBlock;\r\n        this._lBlock = this._rBlock;\r\n        this._rBlock = t;\r\n        // Final permutation\r\n        this._exchangeLR(1, 0x55555555);\r\n        this._exchangeRL(8, 0x00ff00ff);\r\n        this._exchangeRL(2, 0x33333333);\r\n        this._exchangeLR(16, 0x0000ffff);\r\n        this._exchangeLR(4, 0x0f0f0f0f);\r\n        // Set output\r\n        words[offset] = this._lBlock;\r\n        words[offset + 1] = this._rBlock;\r\n    }\r\n    _exchangeLR(offset, mask) {\r\n        const t = ((this._lBlock >>> offset) ^ this._rBlock) & mask;\r\n        this._rBlock ^= t;\r\n        this._lBlock ^= t << offset;\r\n    }\r\n    _exchangeRL(offset, mask) {\r\n        const t = ((this._rBlock >>> offset) ^ this._lBlock) & mask;\r\n        this._lBlock ^= t;\r\n        this._rBlock ^= t << offset;\r\n    }\r\n    /**\r\n     * Creates this cipher in encryption mode.\r\n     *\r\n     * @param {Word32Array} key The key.\r\n     * @param {Partial<CipherProps>?} props (Optional) The configuration options to use for this operation.\r\n     * @return {Cipher} A cipher instance.\r\n     * @example\r\n     *   var cipher = DES.createEncryptor(keyWordArray, { iv: ivWordArray });\r\n     */\r\n    static createEncryptor(key, props) {\r\n        props = typeof props === \"undefined\" ? {} : props;\r\n        return new DES(Object.assign(Object.assign({}, props), { key, transformMode: Cipher.ENC_TRANSFORM_MODE }));\r\n    }\r\n    /**\r\n     * Creates this cipher in decryption mode.\r\n     *\r\n     * @param {Word32Array} key The key.\r\n     * @param {Partial<CipherProps>?} props (Optional) The configuration options to use for this operation.\r\n     * @return {Cipher} A cipher instance.\r\n     * @example\r\n     *   var cipher = DES.createDecryptor(keyWordArray, { iv: ivWordArray });\r\n     */\r\n    static createDecryptor(key, props) {\r\n        props = typeof props === \"undefined\" ? {} : props;\r\n        return new DES(Object.assign(Object.assign({}, props), { key, transformMode: Cipher.DEC_TRANSFORM_MODE }));\r\n    }\r\n    /**\r\n     * Encrypt a message with key\r\n     *\r\n     * @param {Word32Array|string} message\r\n     * @param {Word32Array|string} key\r\n     * @param {Partial<AESProps>?} props\r\n     * @example\r\n     *   var encryptedMessage = DES.encrypt(\"test\", \"pass\");\r\n     */\r\n    static encrypt(message, key, props) {\r\n        if (typeof key === \"string\") {\r\n            return PasswordBasedCipher.encrypt(DES, message, key, props);\r\n        }\r\n        return SerializableCipher.encrypt(DES, message, key, props);\r\n    }\r\n    /**\r\n     * Encrypt a encrypted message with key\r\n     *\r\n     * @param {CipherParams} cipherText\r\n     * @param {Word32Array|string} key\r\n     * @param {Partial<AESProps>?} props\r\n     * @example\r\n     *   var encryptedMessage = DES.decrypt(cipherProps, \"pass\");\r\n     */\r\n    static decrypt(cipherText, key, props) {\r\n        if (typeof key === \"string\") {\r\n            return PasswordBasedCipher.decrypt(DES, cipherText, key, props);\r\n        }\r\n        return SerializableCipher.decrypt(DES, cipherText, key, props);\r\n    }\r\n}\r\nDES.keySize = 64 / 32;\r\nDES.ivSize = 64 / 32;\r\nDES._blockSize = 64 / 32;\r\n","import { SerializableCipher } from \"./lib/algorithm/cipher/SerializableCipher\";\r\nimport { BlockCipher } from \"./lib/algorithm/cipher/BlockCipher\";\r\nimport { Cipher } from \"./lib/algorithm/cipher/Cipher\";\r\nimport { DES } from \"./DES\";\r\nimport { Word32Array } from \"./lib/Word32Array\";\r\nimport { PasswordBasedCipher } from \"./lib/algorithm/cipher/PasswordBasedCipher\";\r\nexport class DES3 extends BlockCipher {\r\n    constructor(props) {\r\n        super(props);\r\n        this._props = props;\r\n        const TripleDES = this._get3DES();\r\n        // Create DES instances\r\n        this._des1 = TripleDES[0];\r\n        this._des2 = TripleDES[1];\r\n        this._des3 = TripleDES[2];\r\n    }\r\n    _get3DES() {\r\n        // Shortcuts\r\n        const key = this._key;\r\n        const keyWords = key.words;\r\n        // Make sure the key length is valid (64, 128 or >= 192 bit)\r\n        if (keyWords.length !== 2 && keyWords.length !== 4 && keyWords.length < 6) {\r\n            throw new Error(\"Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.\");\r\n        }\r\n        // Extend the key according to the keying options defined in 3DES standard\r\n        const key1 = keyWords.slice(0, 2);\r\n        const key2 = keyWords.length < 4 ? keyWords.slice(0, 2) : keyWords.slice(2, 4);\r\n        const key3 = keyWords.length < 6 ? keyWords.slice(0, 2) : keyWords.slice(4, 6);\r\n        // Create DES instances\r\n        const des1 = DES.createEncryptor(new Word32Array(key1));\r\n        const des2 = DES.createEncryptor(new Word32Array(key2));\r\n        const des3 = DES.createEncryptor(new Word32Array(key3));\r\n        return [des1, des2, des3];\r\n    }\r\n    _doReset() {\r\n        const TripleDES = this._get3DES();\r\n        // Create DES instances\r\n        this._des1 = TripleDES[0];\r\n        this._des2 = TripleDES[1];\r\n        this._des3 = TripleDES[2];\r\n    }\r\n    encryptBlock(words, offset) {\r\n        this._des1.encryptBlock(words, offset);\r\n        this._des2.decryptBlock(words, offset);\r\n        this._des3.encryptBlock(words, offset);\r\n    }\r\n    decryptBlock(words, offset) {\r\n        this._des3.decryptBlock(words, offset);\r\n        this._des2.encryptBlock(words, offset);\r\n        this._des1.decryptBlock(words, offset);\r\n    }\r\n    /**\r\n     * Creates this cipher in encryption mode.\r\n     *\r\n     * @param {Word32Array} key The key.\r\n     * @param {Partial<CipherProps>?} props (Optional) The configuration options to use for this operation.\r\n     * @return {Cipher} A cipher instance.\r\n     * @example\r\n     *   var cipher = DES3.createEncryptor(keyWordArray, { iv: ivWordArray });\r\n     */\r\n    static createEncryptor(key, props) {\r\n        props = typeof props === \"undefined\" ? {} : props;\r\n        return new DES3(Object.assign(Object.assign({}, props), { key, transformMode: Cipher.ENC_TRANSFORM_MODE }));\r\n    }\r\n    /**\r\n     * Creates this cipher in decryption mode.\r\n     *\r\n     * @param {Word32Array} key The key.\r\n     * @param {Partial<CipherProps>?} props (Optional) The configuration options to use for this operation.\r\n     * @return {Cipher} A cipher instance.\r\n     * @example\r\n     *   var cipher = DES3.createDecryptor(keyWordArray, { iv: ivWordArray });\r\n     */\r\n    static createDecryptor(key, props) {\r\n        props = typeof props === \"undefined\" ? {} : props;\r\n        return new DES3(Object.assign(Object.assign({}, props), { key, transformMode: Cipher.DEC_TRANSFORM_MODE }));\r\n    }\r\n    /**\r\n     * Encrypt a message with key\r\n     *\r\n     * @param {Word32Array|string} message\r\n     * @param {Word32Array|string} key\r\n     * @param {Partial<AESProps>?} props\r\n     * @example\r\n     *   var encryptedMessage = DES3.encrypt(\"test\", \"pass\");\r\n     */\r\n    static encrypt(message, key, props) {\r\n        if (typeof key === \"string\") {\r\n            return PasswordBasedCipher.encrypt(DES3, message, key, props);\r\n        }\r\n        return SerializableCipher.encrypt(DES3, message, key, props);\r\n    }\r\n    /**\r\n     * Encrypt a encrypted message with key\r\n     *\r\n     * @param {CipherParams} cipherText\r\n     * @param {Word32Array|string} key\r\n     * @param {Partial<AESProps>?} props\r\n     * @example\r\n     *   var encryptedMessage = DES3.decrypt(cipherProps, \"pass\");\r\n     */\r\n    static decrypt(cipherText, key, props) {\r\n        if (typeof key === \"string\") {\r\n            return PasswordBasedCipher.decrypt(DES3, cipherText, key, props);\r\n        }\r\n        return SerializableCipher.decrypt(DES3, cipherText, key, props);\r\n    }\r\n}\r\nDES3.keySize = 192 / 32;\r\nDES3.ivSize = 64 / 32;\r\nDES3._blockSize = 64 / 32;\r\n","import { Word32Array } from \"./lib/Word32Array\";\r\nimport { Hasher } from \"./lib/algorithm/Hasher\";\r\n// Constants table\r\nconst T = [];\r\n(function computeConstant() {\r\n    for (let i = 0; i < 64; i++) {\r\n        T[i] = (Math.abs(Math.sin(i + 1)) * 0x100000000) | 0;\r\n    }\r\n})();\r\nfunction FF(a, b, c, d, x, s, t) {\r\n    const n = a + ((b & c) | (~b & d)) + x + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n}\r\nfunction GG(a, b, c, d, x, s, t) {\r\n    const n = a + ((b & d) | (c & ~d)) + x + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n}\r\nfunction HH(a, b, c, d, x, s, t) {\r\n    const n = a + (b ^ c ^ d) + x + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n}\r\nfunction II(a, b, c, d, x, s, t) {\r\n    const n = a + (c ^ (b | ~d)) + x + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n}\r\n/**\r\n * MD5 hash algorithm\r\n */\r\nexport class MD5 extends Hasher {\r\n    constructor(props) {\r\n        super(props);\r\n        this._hash = new Word32Array([\r\n            0x67452301, 0xefcdab89,\r\n            0x98badcfe, 0x10325476\r\n        ]);\r\n        if (props && typeof props.hash !== \"undefined\") {\r\n            this._hash = props.hash.clone();\r\n        }\r\n    }\r\n    _doReset() {\r\n        this._hash = new Word32Array([\r\n            0x67452301, 0xefcdab89,\r\n            0x98badcfe, 0x10325476\r\n        ]);\r\n    }\r\n    _doProcessBlock(words, offset) {\r\n        // Swap endian\r\n        for (let i = 0; i < 16; i++) {\r\n            // Shortcuts\r\n            const offsetI = offset + i;\r\n            const wordsOffsetI = words[offsetI];\r\n            words[offsetI] = ((((wordsOffsetI << 8) | (wordsOffsetI >>> 24)) & 0x00ff00ff)\r\n                | (((wordsOffsetI << 24) | (wordsOffsetI >>> 8)) & 0xff00ff00));\r\n        }\r\n        // Shortcuts\r\n        const H = this._hash.words;\r\n        const wordOffset0 = words[offset];\r\n        const wordOffset1 = words[offset + 1];\r\n        const wordOffset2 = words[offset + 2];\r\n        const wordOffset3 = words[offset + 3];\r\n        const wordOffset4 = words[offset + 4];\r\n        const wordOffset5 = words[offset + 5];\r\n        const wordOffset6 = words[offset + 6];\r\n        const wordOffset7 = words[offset + 7];\r\n        const wordOffset8 = words[offset + 8];\r\n        const wordOffset9 = words[offset + 9];\r\n        const wordOffset10 = words[offset + 10];\r\n        const wordOffset11 = words[offset + 11];\r\n        const wordOffset12 = words[offset + 12];\r\n        const wordOffset13 = words[offset + 13];\r\n        const wordOffset14 = words[offset + 14];\r\n        const wordOffset15 = words[offset + 15];\r\n        // Working variables\r\n        let a = H[0];\r\n        let b = H[1];\r\n        let c = H[2];\r\n        let d = H[3];\r\n        // Computation\r\n        a = FF(a, b, c, d, wordOffset0, 7, T[0]);\r\n        d = FF(d, a, b, c, wordOffset1, 12, T[1]);\r\n        c = FF(c, d, a, b, wordOffset2, 17, T[2]);\r\n        b = FF(b, c, d, a, wordOffset3, 22, T[3]);\r\n        a = FF(a, b, c, d, wordOffset4, 7, T[4]);\r\n        d = FF(d, a, b, c, wordOffset5, 12, T[5]);\r\n        c = FF(c, d, a, b, wordOffset6, 17, T[6]);\r\n        b = FF(b, c, d, a, wordOffset7, 22, T[7]);\r\n        a = FF(a, b, c, d, wordOffset8, 7, T[8]);\r\n        d = FF(d, a, b, c, wordOffset9, 12, T[9]);\r\n        c = FF(c, d, a, b, wordOffset10, 17, T[10]);\r\n        b = FF(b, c, d, a, wordOffset11, 22, T[11]);\r\n        a = FF(a, b, c, d, wordOffset12, 7, T[12]);\r\n        d = FF(d, a, b, c, wordOffset13, 12, T[13]);\r\n        c = FF(c, d, a, b, wordOffset14, 17, T[14]);\r\n        b = FF(b, c, d, a, wordOffset15, 22, T[15]);\r\n        a = GG(a, b, c, d, wordOffset1, 5, T[16]);\r\n        d = GG(d, a, b, c, wordOffset6, 9, T[17]);\r\n        c = GG(c, d, a, b, wordOffset11, 14, T[18]);\r\n        b = GG(b, c, d, a, wordOffset0, 20, T[19]);\r\n        a = GG(a, b, c, d, wordOffset5, 5, T[20]);\r\n        d = GG(d, a, b, c, wordOffset10, 9, T[21]);\r\n        c = GG(c, d, a, b, wordOffset15, 14, T[22]);\r\n        b = GG(b, c, d, a, wordOffset4, 20, T[23]);\r\n        a = GG(a, b, c, d, wordOffset9, 5, T[24]);\r\n        d = GG(d, a, b, c, wordOffset14, 9, T[25]);\r\n        c = GG(c, d, a, b, wordOffset3, 14, T[26]);\r\n        b = GG(b, c, d, a, wordOffset8, 20, T[27]);\r\n        a = GG(a, b, c, d, wordOffset13, 5, T[28]);\r\n        d = GG(d, a, b, c, wordOffset2, 9, T[29]);\r\n        c = GG(c, d, a, b, wordOffset7, 14, T[30]);\r\n        b = GG(b, c, d, a, wordOffset12, 20, T[31]);\r\n        a = HH(a, b, c, d, wordOffset5, 4, T[32]);\r\n        d = HH(d, a, b, c, wordOffset8, 11, T[33]);\r\n        c = HH(c, d, a, b, wordOffset11, 16, T[34]);\r\n        b = HH(b, c, d, a, wordOffset14, 23, T[35]);\r\n        a = HH(a, b, c, d, wordOffset1, 4, T[36]);\r\n        d = HH(d, a, b, c, wordOffset4, 11, T[37]);\r\n        c = HH(c, d, a, b, wordOffset7, 16, T[38]);\r\n        b = HH(b, c, d, a, wordOffset10, 23, T[39]);\r\n        a = HH(a, b, c, d, wordOffset13, 4, T[40]);\r\n        d = HH(d, a, b, c, wordOffset0, 11, T[41]);\r\n        c = HH(c, d, a, b, wordOffset3, 16, T[42]);\r\n        b = HH(b, c, d, a, wordOffset6, 23, T[43]);\r\n        a = HH(a, b, c, d, wordOffset9, 4, T[44]);\r\n        d = HH(d, a, b, c, wordOffset12, 11, T[45]);\r\n        c = HH(c, d, a, b, wordOffset15, 16, T[46]);\r\n        b = HH(b, c, d, a, wordOffset2, 23, T[47]);\r\n        a = II(a, b, c, d, wordOffset0, 6, T[48]);\r\n        d = II(d, a, b, c, wordOffset7, 10, T[49]);\r\n        c = II(c, d, a, b, wordOffset14, 15, T[50]);\r\n        b = II(b, c, d, a, wordOffset5, 21, T[51]);\r\n        a = II(a, b, c, d, wordOffset12, 6, T[52]);\r\n        d = II(d, a, b, c, wordOffset3, 10, T[53]);\r\n        c = II(c, d, a, b, wordOffset10, 15, T[54]);\r\n        b = II(b, c, d, a, wordOffset1, 21, T[55]);\r\n        a = II(a, b, c, d, wordOffset8, 6, T[56]);\r\n        d = II(d, a, b, c, wordOffset15, 10, T[57]);\r\n        c = II(c, d, a, b, wordOffset6, 15, T[58]);\r\n        b = II(b, c, d, a, wordOffset13, 21, T[59]);\r\n        a = II(a, b, c, d, wordOffset4, 6, T[60]);\r\n        d = II(d, a, b, c, wordOffset11, 10, T[61]);\r\n        c = II(c, d, a, b, wordOffset2, 15, T[62]);\r\n        b = II(b, c, d, a, wordOffset9, 21, T[63]);\r\n        // Intermediate hash value\r\n        H[0] = (H[0] + a) | 0;\r\n        H[1] = (H[1] + b) | 0;\r\n        H[2] = (H[2] + c) | 0;\r\n        H[3] = (H[3] + d) | 0;\r\n    }\r\n    _doFinalize() {\r\n        // Shortcuts\r\n        const data = this._data;\r\n        const dataWords = data.words;\r\n        const nBitsTotal = this._nBytes * 8;\r\n        const nBitsLeft = data.nSigBytes * 8;\r\n        // Add padding\r\n        dataWords[nBitsLeft >>> 5] |= 0x80 << (24 - nBitsLeft % 32);\r\n        const nBitsTotalH = Math.floor(nBitsTotal / 0x100000000);\r\n        const nBitsTotalL = nBitsTotal;\r\n        dataWords[(((nBitsLeft + 64) >>> 9) << 4) + 15] = ((((nBitsTotalH << 8) | (nBitsTotalH >>> 24)) & 0x00ff00ff) |\r\n            (((nBitsTotalH << 24) | (nBitsTotalH >>> 8)) & 0xff00ff00));\r\n        dataWords[(((nBitsLeft + 64) >>> 9) << 4) + 14] = ((((nBitsTotalL << 8) | (nBitsTotalL >>> 24)) & 0x00ff00ff) |\r\n            (((nBitsTotalL << 24) | (nBitsTotalL >>> 8)) & 0xff00ff00));\r\n        data.nSigBytes = (dataWords.length + 1) * 4;\r\n        // Hash final blocks\r\n        this._process();\r\n        // Shortcuts\r\n        const hash = this._hash;\r\n        const H = hash.words;\r\n        // Swap endian\r\n        for (let i = 0; i < 4; i++) {\r\n            // Shortcut\r\n            const Hi = H[i];\r\n            H[i] = (((Hi << 8) | (Hi >>> 24)) & 0x00ff00ff)\r\n                | (((Hi << 24) | (Hi >>> 8)) & 0xff00ff00);\r\n        }\r\n        // Return final computed hash\r\n        return hash;\r\n    }\r\n    clone() {\r\n        const props = { hash: this._hash, blockSize: this._blockSize, data: this._data, nBytes: this._nBytes };\r\n        return new MD5(props);\r\n    }\r\n    static hash(message) {\r\n        return new MD5().finalize(message);\r\n    }\r\n}\r\n","import { Hex } from \"./encoder/Hex\";\r\nimport { random } from \"./random\";\r\n/**\r\n * An array of 32bit words\r\n */\r\nexport class Word32Array {\r\n    /**\r\n     * Initializes a newly created word array.\r\n     *\r\n     * @param {Array} words (Optional) An array of 32-bit words.\r\n     * @param {number} nSignificantBytes (Optional) The number of significant bytes in the words.\r\n     *\r\n     * @example\r\n     *   var wordArray = new WordArray();\r\n     *   var wordArray = new WordArray([0x00010203, 0x04050607]);\r\n     *   var wordArray = new WordArray([0x00010203, 0x04050607], 6);\r\n     */\r\n    constructor(words, nSignificantBytes) {\r\n        this._words = words || [];\r\n        this._nSignificantBytes = typeof nSignificantBytes === \"number\" ? nSignificantBytes : this._words.length * 4;\r\n    }\r\n    get nSigBytes() {\r\n        return this._nSignificantBytes;\r\n    }\r\n    /**\r\n     * Set significant bytes\r\n     * @param {number} n - significant bytes\r\n     */\r\n    set nSigBytes(n) {\r\n        this._nSignificantBytes = n;\r\n    }\r\n    /**\r\n     * Get raw reference of internal words.\r\n     * Modification of this raw array will affect internal words.\r\n     */\r\n    get words() {\r\n        return this._words;\r\n    }\r\n    /**\r\n     * Converts this word array to a string.\r\n     *\r\n     * @param {IEncoder?} encoder The encoding strategy to use. Default: CryptoJS.enc.Hex\r\n     * @return {string} The stringified word array.\r\n     * @example\r\n     *   var string = wordArray + '';\r\n     *   var string = wordArray.toString();\r\n     *   var string = wordArray.toString(Utf8);\r\n     */\r\n    toString(encoder) {\r\n        if (!encoder) {\r\n            return Hex.stringify(this);\r\n        }\r\n        return encoder.stringify(this);\r\n    }\r\n    /**\r\n     * Concatenates a word array to this word array.\r\n     *\r\n     * @param {Word32Array} w The word array to append.\r\n     * @return {Word32Array} This word array.\r\n     * @example\r\n     *   wordArray1.concat(wordArray2);\r\n     */\r\n    concat(w) {\r\n        const words = w.words.slice();\r\n        const N = w.nSigBytes;\r\n        this.clamp();\r\n        if (this._nSignificantBytes % 4) {\r\n            // Copy one byte at a time\r\n            for (let i = 0; i < N; i++) {\r\n                const b = (words[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff;\r\n                this._words[(this._nSignificantBytes + i) >>> 2] |= b << (24 - ((this._nSignificantBytes + i) % 4) * 8);\r\n            }\r\n        }\r\n        else {\r\n            // Copy one word at a time\r\n            for (let i = 0; i < N; i += 4) {\r\n                this._words[(this._nSignificantBytes + i) >>> 2] = words[i >>> 2];\r\n            }\r\n        }\r\n        this._nSignificantBytes += N;\r\n        // Chainable\r\n        return this;\r\n    }\r\n    /**\r\n     * Removes insignificant bits.\r\n     *\r\n     * @example\r\n     *   wordArray.clamp();\r\n     */\r\n    clamp() {\r\n        const n = this._nSignificantBytes;\r\n        this._words[n >>> 2] &= 0xffffffff << (32 - (n % 4) * 8);\r\n        this._words.length = Math.ceil(n / 4);\r\n    }\r\n    /**\r\n     * Creates a copy of this word array.\r\n     *\r\n     * @return {Word32Array} The clone.\r\n     * @example\r\n     *   var clone = word32Array.clone();\r\n     */\r\n    clone() {\r\n        return new Word32Array(this._words.slice(), this._nSignificantBytes);\r\n    }\r\n    /**\r\n     * Creates a word array filled with random bytes.\r\n     *\r\n     * @param {number} nBytes The number of random bytes to generate.\r\n     * @return {Word32Array} The random word array.\r\n     * @static\r\n     * @example\r\n     *   var wordArray = Word32Array.random(16);\r\n     */\r\n    static random(nBytes) {\r\n        const words = [];\r\n        for (let i = 0; i < nBytes; i++) {\r\n            words.push(random());\r\n        }\r\n        return new Word32Array(words, nBytes);\r\n    }\r\n}\r\n","import { Word32Array } from \"../Word32Array\";\r\nimport { Utf8 } from \"../encoder/Utf8\";\r\nexport class BufferedBlockAlgorithm {\r\n    constructor(props) {\r\n        this._minBufferSize = 0;\r\n        this._blockSize = 0;\r\n        this._props = props;\r\n        this._data = props && typeof props.data !== \"undefined\" ? props.data.clone() : new Word32Array();\r\n        this._nBytes = props && typeof props.nBytes === \"number\" ? props.nBytes : 0;\r\n    }\r\n    get blockSize() {\r\n        return this._blockSize;\r\n    }\r\n    /**\r\n     * Resets this block algorithm's data buffer to its initial state.\r\n     *\r\n     * @example\r\n     *   bufferedBlockAlgorithm.reset();\r\n     */\r\n    reset(data, nBytes) {\r\n        this._data = typeof data !== \"undefined\" ? data.clone() : new Word32Array();\r\n        this._nBytes = typeof nBytes === \"number\" ? nBytes : 0;\r\n    }\r\n    /**\r\n     * Adds new data to this block algorithm's buffer.\r\n     *\r\n     * @param {Word32Array|string} data The data to append. Strings are converted to a WordArray using UTF-8.\r\n     * @example\r\n     *   bufferedBlockAlgorithm.append('data');\r\n     *   bufferedBlockAlgorithm.append(wordArray);\r\n     */\r\n    _append(data) {\r\n        const d = typeof data === \"string\" ? Utf8.parse(data) : data;\r\n        this._data.concat(d);\r\n        this._nBytes += d.nSigBytes;\r\n    }\r\n    /**\r\n     * Processes available data blocks.\r\n     * This method invokes doProcessBlock(offset), which must be implemented by a concrete subtype.\r\n     *\r\n     * @param {boolean?} doFlush Whether all blocks and partial blocks should be processed.\r\n     * @return {Word32Array} The processed data.\r\n     * @example\r\n     *   var processedData = bufferedBlockAlgorithm.process();\r\n     *   var processedData = bufferedBlockAlgorithm.process(!!'flush');\r\n     */\r\n    _process(doFlush) {\r\n        let processedWords;\r\n        const words = this._data.words;\r\n        const nSigBytes = this._data.nSigBytes;\r\n        const blockSize = this._blockSize;\r\n        const blockSizeByte = this._blockSize * 4;\r\n        let nBlocksReady = nSigBytes / blockSizeByte;\r\n        if (doFlush) {\r\n            // Round up to include partial blocks\r\n            nBlocksReady = Math.ceil(nBlocksReady);\r\n        }\r\n        else {\r\n            nBlocksReady = Math.max((nBlocksReady | 0) - this._minBufferSize, 0);\r\n        }\r\n        // Count words ready\r\n        const nWordsReady = nBlocksReady * blockSize;\r\n        // Count bytes ready\r\n        const nBytesReady = Math.min(nWordsReady * 4, nSigBytes);\r\n        // Process blocks\r\n        if (nWordsReady) {\r\n            for (let offset = 0; offset < nWordsReady; offset += blockSize) {\r\n                // Perform concrete-algorithm logic\r\n                this._doProcessBlock(words, offset);\r\n            }\r\n            // Remove processed words\r\n            processedWords = words.splice(0, nWordsReady);\r\n            this._data.nSigBytes -= nBytesReady;\r\n        }\r\n        // Return processed words\r\n        return new Word32Array(processedWords, nBytesReady);\r\n    }\r\n    /**\r\n     * @abstract\r\n     */\r\n    _doProcessBlock(words, offset) {\r\n        throw new Error(\"Not implemented\");\r\n    }\r\n}\r\n","import { BufferedBlockAlgorithm } from \"./BufferedBlockAlgorithm\";\r\nexport class Hasher extends BufferedBlockAlgorithm {\r\n    constructor(props) {\r\n        super(props);\r\n        this._blockSize = 512 / 32;\r\n        this._props = props;\r\n        if (props && typeof props.blockSize === \"number\") {\r\n            this._blockSize = props.blockSize;\r\n        }\r\n        this.reset(props ? props.data : undefined, props ? props.nBytes : undefined);\r\n    }\r\n    get blockSize() {\r\n        return this._blockSize;\r\n    }\r\n    /**\r\n     * Resets this hasher to its initial state.\r\n     *\r\n     * @example\r\n     *   hasher.reset();\r\n     */\r\n    reset(data, nBytes) {\r\n        // Reset data buffer\r\n        super.reset.call(this, data, nBytes);\r\n        // Perform concrete-hasher logic\r\n        this._doReset();\r\n    }\r\n    /**\r\n     * Updates this hasher with a message.\r\n     *\r\n     * @param {Word32Array|string} messageUpdate The message to append.\r\n     * @return {Hasher} This hasher.\r\n     * @example\r\n     *   hasher.update('message');\r\n     *   hasher.update(wordArray);\r\n     */\r\n    update(messageUpdate) {\r\n        this._append(messageUpdate);\r\n        this._process();\r\n        return this;\r\n    }\r\n    /**\r\n     * Finalizes the hash computation.\r\n     * Note that the finalize operation is effectively a destructive, read-once operation.\r\n     *\r\n     * @param {Word32Array|string?} messageUpdate (Optional) A final message update.\r\n     * @return {Word32Array} The hash.\r\n     * @example\r\n     *   var hash = hasher.finalize();\r\n     *   var hash = hasher.finalize('message');\r\n     *   var hash = hasher.finalize(wordArray);\r\n     */\r\n    finalize(messageUpdate) {\r\n        // Final message update\r\n        if (messageUpdate) {\r\n            this._append(messageUpdate);\r\n        }\r\n        // Perform concrete-hasher logic\r\n        return this._doFinalize();\r\n    }\r\n    /**\r\n     * @abstract\r\n     */\r\n    _doReset() {\r\n        throw new Error(\"Not implemented\");\r\n    }\r\n    /**\r\n     * @abstract\r\n     */\r\n    _doFinalize() {\r\n        throw new Error(\"Not implemented\");\r\n    }\r\n}\r\n","import { Cipher } from \"./Cipher\";\r\nimport { ECB } from \"./mode/ECB\";\r\nimport { Noop } from \"./pad/Noop\";\r\nexport class BlockCipher extends Cipher {\r\n    constructor(props) {\r\n        super(props);\r\n        this._blockSize = 128 / 32;\r\n        this._Mode = ECB;\r\n        this._padding = Noop;\r\n        this._props = props;\r\n        this._Mode = typeof props.mode !== \"undefined\" ? props.mode : this._Mode;\r\n        this._padding = typeof props.padding !== \"undefined\" ? props.padding : this._padding;\r\n        this.reset(props === null || props === void 0 ? void 0 : props.data, props === null || props === void 0 ? void 0 : props.nBytes);\r\n    }\r\n    get mode() {\r\n        return this._mode;\r\n    }\r\n    get padding() {\r\n        return this._padding;\r\n    }\r\n    reset(data, nBytes) {\r\n        super.reset(data, nBytes);\r\n        let modeCreator;\r\n        if (this._transformMode === Cipher.ENC_TRANSFORM_MODE) {\r\n            modeCreator = this._Mode.createEncryptor;\r\n        }\r\n        else {\r\n            modeCreator = this._Mode.createDecryptor;\r\n            // Keep at least one block in the buffer for unpadding\r\n            this._minBufferSize = 1;\r\n        }\r\n        if (this._Mode && this._modeCreator === modeCreator) {\r\n            this._mode = new this._Mode({ cipher: this, iv: this._iv && this._iv.words });\r\n        }\r\n        else {\r\n            this._mode = modeCreator.call(this._Mode, { cipher: this, iv: this._iv && this._iv.words });\r\n            this._modeCreator = modeCreator;\r\n        }\r\n    }\r\n    _doProcessBlock(words, offset) {\r\n        var _a;\r\n        (_a = this._mode) === null || _a === void 0 ? void 0 : _a.processBlock(words, offset);\r\n    }\r\n    _doFinalize() {\r\n        let finalProcessedBlocks;\r\n        // Shortcut\r\n        const padding = this._padding;\r\n        // Finalize\r\n        if (this._transformMode === Cipher.ENC_TRANSFORM_MODE) {\r\n            // Pad data\r\n            padding.pad(this._data, this.blockSize);\r\n            // Process final blocks\r\n            finalProcessedBlocks = this._process(true);\r\n        }\r\n        else /* if (this._transformMode == Cipher._DEC_TRANSFORM_MODE) */ {\r\n            // Process final blocks\r\n            finalProcessedBlocks = this._process(true);\r\n            // Unpad data\r\n            padding.unpad(finalProcessedBlocks);\r\n        }\r\n        return finalProcessedBlocks;\r\n    }\r\n    /**\r\n     * @abstract\r\n     */\r\n    encryptBlock(words, offset) {\r\n        throw new Error(\"Not implemented\");\r\n    }\r\n    /**\r\n     * @abstract\r\n     */\r\n    decryptBlock(words, offset) {\r\n        throw new Error(\"Not implemented\");\r\n    }\r\n    /**\r\n     * Creates this cipher in encryption mode.\r\n     *\r\n     * @param {Word32Array} key The key.\r\n     * @param {Partial<CipherProps>?} props (Optional) The configuration options to use for this operation.\r\n     * @return {Cipher} A cipher instance.\r\n     * @example\r\n     *     var cipher = AES.createEncryptor(keyWordArray, { iv: ivWordArray });\r\n     */\r\n    static createEncryptor(key, props) {\r\n        props = typeof props === \"undefined\" ? {} : props;\r\n        return new BlockCipher(Object.assign(Object.assign({}, props), { key, transformMode: Cipher.ENC_TRANSFORM_MODE }));\r\n    }\r\n    /**\r\n     * Creates this cipher in decryption mode.\r\n     * @param {Word32Array} key The key.\r\n     * @param {Partial<CipherProps>?} props (Optional) The configuration options to use for this operation.\r\n     * @return {Cipher} A cipher instance.\r\n     * @example\r\n     *   var cipher = AES.createDecryptor(keyWordArray, { iv: ivWordArray });\r\n     */\r\n    static createDecryptor(key, props) {\r\n        props = typeof props === \"undefined\" ? {} : props;\r\n        return new BlockCipher(Object.assign(Object.assign({}, props), { key, transformMode: Cipher.DEC_TRANSFORM_MODE }));\r\n    }\r\n}\r\n","import { BufferedBlockAlgorithm } from \"../BufferedBlockAlgorithm\";\r\nexport class Cipher extends BufferedBlockAlgorithm {\r\n    constructor(props) {\r\n        super(props);\r\n        this._transformMode = 1;\r\n        this._props = props;\r\n        this._key = props.key;\r\n        this._iv = typeof props.iv !== \"undefined\" ? props.iv : this._iv;\r\n        this._transformMode = typeof props.transformMode !== \"undefined\" ? props.transformMode : this._transformMode;\r\n    }\r\n    get iv() {\r\n        return this._iv;\r\n    }\r\n    /**\r\n     * Resets this cipher to its initial state.\r\n     * @example\r\n     *   cipher.reset();\r\n     */\r\n    reset(data, nBytes) {\r\n        super.reset(data, nBytes);\r\n        this._doReset();\r\n    }\r\n    /**\r\n     * Adds data to be encrypted or decrypted.\r\n     * @param {Word32Array|string} dataUpdate The data to encrypt or decrypt.\r\n     * @return {Word32Array} The data after processing.\r\n     * @example\r\n     *   var encrypted = cipher.process('data');\r\n     *   var encrypted = cipher.process(wordArray);\r\n     */\r\n    process(dataUpdate) {\r\n        this._append(dataUpdate);\r\n        return this._process();\r\n    }\r\n    /**\r\n     * Finalizes the encryption or decryption process.\r\n     * Note that the finalize operation is effectively a destructive, read-once operation.\r\n     * @param {Word32Array|string?} dataUpdate The final data to encrypt or decrypt.\r\n     * @return {Word32Array} The data after final processing.\r\n     * @example\r\n     *   var encrypted = cipher.finalize();\r\n     *   var encrypted = cipher.finalize('data');\r\n     *   var encrypted = cipher.finalize(wordArray);\r\n     */\r\n    finalize(dataUpdate) {\r\n        // Final data update\r\n        if (dataUpdate) {\r\n            this._append(dataUpdate);\r\n        }\r\n        // Perform concrete-cipher logic\r\n        return this._doFinalize();\r\n    }\r\n    /**\r\n     * @abstract\r\n     */\r\n    _doReset() {\r\n        throw new Error(\"Not implemented\");\r\n    }\r\n    /**\r\n     * @abstract\r\n     */\r\n    _doProcessBlock(words, offset) {\r\n        throw new Error(\"Not implemented\");\r\n    }\r\n    /**\r\n     * @abstract\r\n     */\r\n    _doFinalize() {\r\n        throw new Error(\"Not implemented\");\r\n    }\r\n    /**\r\n     * Creates this cipher in encryption mode.\r\n     *\r\n     * @param {Word32Array} key The key.\r\n     * @param {Partial<CipherProps>?} props (Optional) The configuration options to use for this operation.\r\n     * @return {Cipher} A cipher instance.\r\n     * @example\r\n     *     var cipher = AES.createEncryptor(keyWordArray, { iv: ivWordArray });\r\n     */\r\n    static createEncryptor(key, props) {\r\n        props = typeof props === \"undefined\" ? {} : props;\r\n        return new Cipher(Object.assign(Object.assign({}, props), { key, transformMode: Cipher.ENC_TRANSFORM_MODE }));\r\n    }\r\n    /**\r\n     * Creates this cipher in decryption mode.\r\n     * @param {Word32Array} key The key.\r\n     * @param {Partial<CipherProps>?} props (Optional) The configuration options to use for this operation.\r\n     * @return {Cipher} A cipher instance.\r\n     * @example\r\n     *   var cipher = AES.createDecryptor(keyWordArray, { iv: ivWordArray });\r\n     */\r\n    static createDecryptor(key, props) {\r\n        props = typeof props === \"undefined\" ? {} : props;\r\n        return new Cipher(Object.assign(Object.assign({}, props), { key, transformMode: Cipher.DEC_TRANSFORM_MODE }));\r\n    }\r\n}\r\nCipher.ENC_TRANSFORM_MODE = 1;\r\nCipher.DEC_TRANSFORM_MODE = 2;\r\nCipher.keySize = 128 / 32;\r\nCipher.ivSize = 128 / 32;\r\n","import { OpenSSLFormatter } from \"./formatter/OpenSSLFormatter\";\r\n/**\r\n * A collection of cipher parameters.\r\n *\r\n * @property {Word32Array} ciphertext The raw ciphertext.\r\n * @property {Word32Array} key The key to this ciphertext.\r\n * @property {Word32Array} iv The IV used in the ciphering operation.\r\n * @property {Word32Array} salt The salt used with a key derivation function.\r\n * @property {typeof Cipher} algorithm The cipher algorithm.\r\n * @property {BlockCipherMode} mode The block mode used in the ciphering operation.\r\n * @property {Pad} padding The padding scheme used in the ciphering operation.\r\n * @property {number} blockSize The block size of the cipher.\r\n * @property {Formatter} formatter The default formatting strategy to convert this cipher params object to a string.\r\n */\r\nexport class CipherParams {\r\n    /**\r\n     * Initializes a newly created cipher params object.\r\n     *\r\n     * @param {Partial<CipherParams>} cp An object with any of the possible cipher parameters.\r\n     * @example\r\n     *   var cipherParams = new CipherParams({\r\n     *       ciphertext: ciphertextWordArray,\r\n     *       key: keyWordArray,\r\n     *       iv: ivWordArray,\r\n     *       salt: saltWordArray,\r\n     *       algorithm: AES,\r\n     *       mode: CBC,\r\n     *       padding: PKCS7,\r\n     *       blockSize: 4,\r\n     *       formatter: OpenSSLFormatter\r\n     *     });\r\n     */\r\n    constructor(cp) {\r\n        this.formatter = OpenSSLFormatter;\r\n        if (cp) {\r\n            this.cipherText = cp.cipherText;\r\n            this.key = cp.key;\r\n            this.iv = cp.iv;\r\n            this.salt = cp.salt;\r\n            this.Algorithm = cp.Algorithm;\r\n            this.mode = cp.mode;\r\n            this.padding = cp.padding;\r\n            this.blockSize = cp.blockSize;\r\n            this.formatter = cp.formatter || OpenSSLFormatter;\r\n        }\r\n    }\r\n    /**\r\n     * Converts this cipher params object to a string.\r\n     *\r\n     * @param {Formatter?} formatter (Optional) The formatting strategy to use.\r\n     * @return {string} The stringified cipher params.\r\n     * @throws Error If neither the formatter nor the default formatter is set.\r\n     * @example\r\n     *   var string = cipherParams + '';\r\n     *   var string = cipherParams.toString();\r\n     *   var string = cipherParams.toString(OpenSSLFormatter);\r\n     */\r\n    toString(formatter) {\r\n        return (formatter || this.formatter).stringify(this);\r\n    }\r\n}\r\n","import { parseCipherText, SerializableCipher, } from \"./SerializableCipher\";\r\nimport { OpenSSLKDF } from \"./kdf/OpenSSLKDF\";\r\nimport { CipherParams } from \"./CipherParams\";\r\nimport { OpenSSLFormatter } from \"./formatter/OpenSSLFormatter\";\r\nexport const PasswordBasedCipher = {\r\n    /**\r\n     * Encrypts a message using a password.\r\n     *\r\n     * @param {typeof Cipher} Cipher The cipher algorithm to use.\r\n     * @param {Word32Array|string} message The message to encrypt.\r\n     * @param {string} password The password.\r\n     * @param {Partial<PasswordBasedCipherProps>?} props (Optional) The configuration options to use for this operation.\r\n     * @return {CipherParams} A cipher params object.\r\n     * @example\r\n     *   var params = PasswordBasedCipher.encrypt(AES, message, 'password');\r\n     *   var params = PasswordBasedCipher.encrypt(AES, message, 'password', { format: OpenSSLFormatter });\r\n     */\r\n    encrypt(Cipher, message, password, props) {\r\n        const p = props ? Object.assign({}, props) : {};\r\n        const KDF = props && props.KDF ? props.KDF : OpenSSLKDF;\r\n        const derivedParams = KDF.execute(password, Cipher.keySize, Cipher.ivSize);\r\n        p.iv = derivedParams.iv;\r\n        const cipherParams = SerializableCipher.encrypt(Cipher, message, derivedParams.key, p);\r\n        return new CipherParams(Object.assign(Object.assign({}, cipherParams), { key: derivedParams.key, iv: derivedParams.iv, salt: derivedParams.salt }));\r\n    },\r\n    /**\r\n     * Decrypts serialized ciphertext using a password.\r\n     *\r\n     * @param {typeof Cipher} Cipher The cipher algorithm to use.\r\n     * @param {CipherParams|string} cipherParams The ciphertext to decrypt.\r\n     * @param {string} password The password.\r\n     * @param {Partial<PasswordBasedCipherProps>?} props (Optional) The configuration options to use for this operation.\r\n     * @return {Word32Array} The plaintext.\r\n     * @example\r\n     *   var plaintext = PasswordBasedCipher.decrypt(\r\n     *     AES,\r\n     *     formattedCiphertext,\r\n     *     'password',\r\n     *     { format: OpenSSLFormatter }\r\n     *   );\r\n     *   var plaintext = PasswordBasedCipher.decrypt(\r\n     *     AES,\r\n     *     ciphertextParams,\r\n     *     'password',\r\n     *     { format: OpenSSLFormatter }\r\n     *   );\r\n     */\r\n    decrypt(Cipher, cipherParams, password, props) {\r\n        const p = props ? Object.assign({}, props) : {};\r\n        const KDF = p.KDF ? p.KDF : OpenSSLKDF;\r\n        const formatter = p.formatter ? p.formatter : OpenSSLFormatter;\r\n        const cipherParamsObj = parseCipherText(cipherParams, formatter);\r\n        const derivedParams = KDF.execute(password, Cipher.keySize, Cipher.ivSize);\r\n        p.iv = derivedParams.iv;\r\n        return SerializableCipher.decrypt(Cipher, cipherParamsObj, derivedParams.key, p);\r\n    }\r\n};\r\n","import { OpenSSLFormatter } from \"./formatter/OpenSSLFormatter\";\r\nimport { CipherParams } from \"./CipherParams\";\r\n/**\r\n * Converts serialized ciphertext to CipherParams,\r\n * else assumed CipherParams already and returns ciphertext unchanged.\r\n * @param {CipherParams|string} cipherTextParams The ciphertext.\r\n * @param {Formatter} formatter The formatting strategy to use to parse serialized ciphertext.\r\n * @return {CipherParams} The un-serialized ciphertext.\r\n * @example\r\n *   var ciphertextParams = SerializableCipher.parse(ciphertextStringOrParams, format);\r\n */\r\nexport function parseCipherText(cipherTextParams, formatter) {\r\n    if (typeof cipherTextParams === \"string\") {\r\n        return formatter.parse(cipherTextParams);\r\n    }\r\n    return cipherTextParams;\r\n}\r\nexport const SerializableCipher = {\r\n    /**\r\n     * Encrypts a message.\r\n     *\r\n     * @param {typeof Cipher} Cipher The cipher algorithm to use.\r\n     * @param {Word32Array|string} message The message to encrypt.\r\n     * @param {Word32Array} key The key.\r\n     * @param {Partial<SerializableCipherProps>?} props (Optional) The configuration options to use for this operation.\r\n     * @return {CipherParams} A cipher params object.\r\n     * @example\r\n     *   var ciphertextParams = SerializableCipher.encrypt(AES, message, key);\r\n     *   var ciphertextParams = SerializableCipher.encrypt(AES, message, key, { iv: iv });\r\n     */\r\n    encrypt(Cipher, message, key, props) {\r\n        const encryptor = Cipher.createEncryptor(key, props);\r\n        const cipherText = encryptor.finalize(message);\r\n        return new CipherParams({\r\n            cipherText,\r\n            key,\r\n            iv: encryptor.iv,\r\n            Algorithm: Cipher,\r\n            mode: encryptor.mode,\r\n            padding: encryptor.padding,\r\n            blockSize: encryptor.blockSize,\r\n            formatter: (props === null || props === void 0 ? void 0 : props.formatter) || OpenSSLFormatter,\r\n        });\r\n    },\r\n    /**\r\n     * Decrypts serialized ciphertext.\r\n     *\r\n     * @param {typeof Cipher} Cipher The cipher algorithm to use.\r\n     * @param {CipherParams|string} cipherParams The ciphertext to decrypt.\r\n     * @param {Word32Array} key The key.\r\n     * @param {Partial<SerializableCipherProps>} props (Optional) The configuration options to use for this operation.\r\n     * @return {Word32Array} The plaintext.\r\n     * @example\r\n     *     var plaintext = SerializableCipher.decrypt(AES, formattedCiphertext, key, { iv: iv, format: OpenSSLFormatter });\r\n     *     var plaintext = SerializableCipher.decrypt(AES, ciphertextParams, key, { iv: iv, format: OpenSSLFormatter });\r\n     */\r\n    decrypt(Cipher, cipherParams, key, props) {\r\n        const decryptor = Cipher.createDecryptor(key, props);\r\n        const cipherParamsObj = parseCipherText(cipherParams, (props === null || props === void 0 ? void 0 : props.formatter) || OpenSSLFormatter);\r\n        return decryptor.finalize(cipherParamsObj.cipherText || \"\");\r\n    }\r\n};\r\n","import { CipherParams } from \"../CipherParams\";\r\nimport { Word32Array } from \"../../../Word32Array\";\r\nimport { Base64 } from \"../../../encoder/Base64\";\r\nexport const OpenSSLFormatter = {\r\n    /**\r\n     * Converts a cipher params object to an OpenSSL-compatible string.\r\n     *\r\n     * @param {CipherParams} cipherParams The cipher params object.\r\n     * @return {string} The OpenSSL-compatible string.\r\n     * @example\r\n     *   var openSSLString = OpenSSLFormatter.stringify(cipherParams);\r\n     */\r\n    stringify(cipherParams) {\r\n        // Shortcuts\r\n        const cipherText = cipherParams.cipherText;\r\n        const salt = cipherParams.salt;\r\n        if (!cipherText) {\r\n            return \"\";\r\n        }\r\n        // Format\r\n        if (salt) {\r\n            const wordArray = new Word32Array([0x53616c74, 0x65645f5f]).concat(salt).concat(cipherText);\r\n            return wordArray.toString(Base64);\r\n        }\r\n        return cipherText.toString(Base64);\r\n    },\r\n    /**\r\n     * Converts an OpenSSL-compatible string to a cipher params object.\r\n     *\r\n     * @param {string} openSSLStr The OpenSSL-compatible string.\r\n     * @return {CipherParams} The cipher params object.\r\n     * @example\r\n     *   var cipherParams = OpenSSLFormatter.parse(openSSLString);\r\n     */\r\n    parse(openSSLStr) {\r\n        let salt;\r\n        // Parse base64\r\n        const cipherText = Base64.parse(openSSLStr);\r\n        // Shortcut\r\n        const ciphertextWords = cipherText.words;\r\n        // Test for salt\r\n        if (ciphertextWords[0] === 0x53616c74 && ciphertextWords[1] === 0x65645f5f) {\r\n            // Extract salt\r\n            salt = new Word32Array(ciphertextWords.slice(2, 4));\r\n            // Remove salt from ciphertext\r\n            ciphertextWords.splice(0, 4);\r\n            cipherText.nSigBytes -= 16;\r\n        }\r\n        return new CipherParams({ cipherText, salt });\r\n    }\r\n};\r\n","import { Word32Array } from \"../../../Word32Array\";\r\nimport { CipherParams } from \"../CipherParams\";\r\nimport { EvpKDF } from \"./module/EvpKDF\";\r\n/**\r\n * Derives a key and IV from a password.\r\n *\r\n * @param {string} password The password to derive from.\r\n * @param {number} keySize The size in words of the key to generate.\r\n * @param {number} ivSize The size in words of the IV to generate.\r\n * @param {Word32Array?} salt (Optional) A 64-bit salt to use. If omitted, a salt will be generated randomly.\r\n * @return {CipherParams} A cipher params object with the key, IV, and salt.\r\n * @example\r\n *   var derivedParams = OpenSSLKDF.execute('Password', 256/32, 128/32);\r\n *   var derivedParams = OpenSSLKDF.execute('Password', 256/32, 128/32, 'saltsalt');\r\n */\r\nexport const OpenSSLKDF = {\r\n    execute(password, keySize, ivSize, salt, props) {\r\n        // Generate random salt\r\n        if (!salt) {\r\n            salt = Word32Array.random(64 / 8);\r\n        }\r\n        const KDFModule = props && props.KDF || EvpKDF;\r\n        const kdfProps = props ? { Hasher: props.Hasher, iterations: props.iterations } : {};\r\n        // Derive key and IV\r\n        const key = KDFModule.getKey(password, salt, Object.assign(Object.assign({}, kdfProps), { keySize: keySize + ivSize }));\r\n        // Separate key and IV\r\n        const iv = new Word32Array(key.words.slice(keySize), ivSize * 4);\r\n        key.nSigBytes = keySize * 4;\r\n        // Return params\r\n        return new CipherParams({ key, iv, salt });\r\n    }\r\n};\r\n","import { MD5 } from \"../../../../../MD5\";\r\nimport { Word32Array } from \"../../../../Word32Array\";\r\nimport { BaseKDFModule } from \"../type\";\r\n/**\r\n * This key derivation function is meant to conform with EVP_BytesToKey.\r\n * https://www.openssl.org/docs/man1.1.1/man3/EVP_BytesToKey.html\r\n *\r\n * @property {number} keySize The key size in words to generate. Default: 4 (128 bits)\r\n * @property {Hasher} hasher The hash algorithm to use. Default: MD5\r\n * @property {number} iterations The number of iterations to perform. Default: 1\r\n */\r\nexport class EvpKDF extends BaseKDFModule {\r\n    constructor(props) {\r\n        super(props);\r\n        this._keySize = 128 / 32;\r\n        this._Hasher = MD5;\r\n        this._iterations = 1;\r\n        if (props) {\r\n            this._keySize = typeof props.keySize !== \"undefined\" ? props.keySize : this._keySize;\r\n            this._Hasher = typeof props.Hasher !== \"undefined\" ? props.Hasher : this._Hasher;\r\n            this._iterations = typeof props.iterations !== \"undefined\" ? props.iterations : this._iterations;\r\n        }\r\n    }\r\n    /**\r\n     * Derives a key from a password.\r\n     *\r\n     * @param {Word32Array|string} password The password.\r\n     * @param {Word32Array|string} salt A salt.\r\n     * @return {Word32Array} The derived key.\r\n     * @example\r\n     *   var kdf = new EvpKDF();\r\n     *   var key = kdf.compute(password, salt);\r\n     */\r\n    compute(password, salt) {\r\n        let block;\r\n        // Init hasher\r\n        const hasher = new this._Hasher();\r\n        // Initial values\r\n        const derivedKey = new Word32Array();\r\n        // Shortcuts\r\n        const derivedKeyWords = derivedKey.words;\r\n        const keySize = this._keySize;\r\n        const iterations = this._iterations;\r\n        // Generate key\r\n        while (derivedKeyWords.length < keySize) {\r\n            if (block) {\r\n                hasher.update(block);\r\n            }\r\n            block = hasher.update(password).finalize(salt);\r\n            hasher.reset();\r\n            // Iterations\r\n            for (let i = 1; i < iterations; i++) {\r\n                block = hasher.finalize(block);\r\n                hasher.reset();\r\n            }\r\n            derivedKey.concat(block);\r\n        }\r\n        derivedKey.nSigBytes = keySize * 4;\r\n        return derivedKey;\r\n    }\r\n    /**\r\n     * Derives a key from a password.\r\n     *\r\n     * @param {Word32Array|string} password The password.\r\n     * @param {Word32Array|string} salt A salt.\r\n     * @param {Partial<EvpKDFProps>?} props (Optional) The configuration options to use for this computation.\r\n     * @return {Word32Array} The derived key.\r\n     * @static\r\n     * @example\r\n     *\r\n     *     var key = EvpKDF.getKey(password, salt);\r\n     *     var key = EvpKDF.getKey(password, salt, { keySize: 8 });\r\n     *     var key = EvpKDF.getKey(password, salt, { keySize: 8, iterations: 1000 });\r\n     */\r\n    static getKey(password, salt, props) {\r\n        return new EvpKDF(props).compute(password, salt);\r\n    }\r\n}\r\n","export class BaseKDFModule {\r\n    constructor(props) {\r\n        this._props = props;\r\n    }\r\n    compute(password, salt) {\r\n        throw new Error(\"Not implemented\");\r\n    }\r\n    static getKey(password, salt, props) {\r\n        throw new Error(\"Not implemented\");\r\n    }\r\n}\r\n","/**\r\n * Abstract base block cipher mode template.\r\n * @abstract\r\n */\r\nexport class BlockCipherMode {\r\n    constructor(props) {\r\n        this._props = props;\r\n        this._cipher = props.cipher;\r\n        this._iv = props.iv;\r\n    }\r\n    /**\r\n     * @abstract\r\n     */\r\n    processBlock(words, offset) {\r\n        return;\r\n    }\r\n    /**\r\n     * Creates this mode for encryption.\r\n     * @param {BlockCipherModeProps} props\r\n     * @abstract\r\n     * @example\r\n     *   var mode = CBC.createEncryptor(cipher, iv.words);\r\n     */\r\n    static createEncryptor(props) {\r\n        throw new Error(\"Not implemented yet\");\r\n    }\r\n    /**\r\n     * Creates this mode for decryption.\r\n     * @param {BlockCipherModeProps} props\r\n     * @abstract\r\n     * @example\r\n     *   var mode = CBC.createDecryptor(cipher, iv.words);\r\n     */\r\n    static createDecryptor(props) {\r\n        throw new Error(\"Not implemented yet\");\r\n    }\r\n}\r\n","import { BlockCipherMode } from \"./BlockCipherMode\";\r\n/**\r\n * Electronic Codebook block mode.\r\n */\r\nexport class ECB extends BlockCipherMode {\r\n    constructor(props) {\r\n        super(props);\r\n    }\r\n    /**\r\n     * Creates this mode for encryption.\r\n     * @param {BlockCipherModeProps} props\r\n     * @example\r\n     *   var mode = ECB.createEncryptor(cipher, iv.words);\r\n     */\r\n    static createEncryptor(props) {\r\n        return new ECB.Encryptor(props);\r\n    }\r\n    /**\r\n     * Creates this mode for decryption.\r\n     * @param {BlockCipherModeProps} props\r\n     * @example\r\n     *   var mode = ECB.createDecryptor(cipher, iv.words);\r\n     */\r\n    static createDecryptor(props) {\r\n        return new ECB.Decryptor(props);\r\n    }\r\n}\r\n/**\r\n * ECB encryptor.\r\n */\r\nECB.Encryptor = class Encryptor extends ECB {\r\n    /**\r\n     * Processes the data block at offset.\r\n     *\r\n     * @param {number[]} words The data words to operate on.\r\n     * @param {number} offset The offset where the block starts.\r\n     * @example\r\n     *   mode.processBlock(data.words, offset);\r\n     */\r\n    processBlock(words, offset) {\r\n        this._cipher.encryptBlock(words, offset);\r\n    }\r\n};\r\n/**\r\n * ECB decryptor.\r\n */\r\nECB.Decryptor = class Decryptor extends ECB {\r\n    /**\r\n     * Processes the data block at offset.\r\n     *\r\n     * @param {number[]} words The data words to operate on.\r\n     * @param {number} offset The offset where the block starts.\r\n     * @example\r\n     *   mode.processBlock(data.words, offset);\r\n     */\r\n    processBlock(words, offset) {\r\n        this._cipher.decryptBlock(words, offset);\r\n    }\r\n};\r\n","/**\r\n * A noop padding strategy\r\n *\r\n * @param {Word32Array} data The data to pad.\r\n * @param {number} blockSize The multiple that the data should be padded to.\r\n * @example\r\n *   Noop.pad(wordArray, 4);\r\n */\r\nfunction pad(data, blockSize) {\r\n    // Noop\r\n}\r\n/**\r\n * Unpads data that had been padded with Noop strategy.\r\n *\r\n * @param {Word32Array} data The data to unpad.\r\n * @example\r\n *   Noop.unpad(wordArray);\r\n */\r\nfunction unpad(data) {\r\n    // Noop\r\n}\r\nexport const Noop = {\r\n    pad,\r\n    unpad,\r\n};\r\n","import { Word32Array } from \"../Word32Array\";\r\nconst map = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\r\nconst reverseMap = [];\r\nfor (let i = 0; i < map.length; i++) {\r\n    reverseMap[map.charCodeAt(i)] = i;\r\n}\r\nexport const Base64 = {\r\n    /**\r\n     * Converts a word array to a base64 string.\r\n     *\r\n     * @param {Word32Array} w An array of 32-bit words.\r\n     * @return {string} The base64 string.\r\n     * @example\r\n     *   var hexString = Base64.stringify(new Word32Array([0x293892], 6));\r\n     */\r\n    stringify(w) {\r\n        // Shortcuts\r\n        const words = w.words;\r\n        const sigBytes = w.nSigBytes;\r\n        // Clamp excess bits\r\n        w.clamp();\r\n        // Convert\r\n        const base64Chars = [];\r\n        for (let i = 0; i < sigBytes; i += 3) {\r\n            const byte1 = (words[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff;\r\n            const byte2 = (words[(i + 1) >>> 2] >>> (24 - ((i + 1) % 4) * 8)) & 0xff;\r\n            const byte3 = (words[(i + 2) >>> 2] >>> (24 - ((i + 2) % 4) * 8)) & 0xff;\r\n            const triplet = (byte1 << 16) | (byte2 << 8) | byte3;\r\n            for (let j = 0; (j < 4) && (i + j * 0.75 < sigBytes); j++) {\r\n                base64Chars.push(map.charAt((triplet >>> (6 * (3 - j))) & 0x3f));\r\n            }\r\n        }\r\n        // Add padding\r\n        const paddingChar = map.charAt(64);\r\n        if (paddingChar) {\r\n            while (base64Chars.length % 4) {\r\n                base64Chars.push(paddingChar);\r\n            }\r\n        }\r\n        return base64Chars.join(\"\");\r\n    },\r\n    /**\r\n     * Converts a base64 string to a word array.\r\n     *\r\n     * @param {string} base64Str The base64 string.\r\n     * @return {Word32Array} The word array.\r\n     * @example\r\n     *   var wordArray = Base64.parse(base64String);\r\n     */\r\n    parse(base64Str) {\r\n        let base64StrLength = base64Str.length;\r\n        // Ignore padding\r\n        const paddingChar = map.charAt(64);\r\n        if (paddingChar) {\r\n            const paddingIndex = base64Str.indexOf(paddingChar);\r\n            if (paddingIndex !== -1) {\r\n                base64StrLength = paddingIndex;\r\n            }\r\n        }\r\n        const words = [];\r\n        let nBytes = 0;\r\n        for (let i = 0; i < base64StrLength; i++) {\r\n            if (i % 4) {\r\n                const bits1 = reverseMap[base64Str.charCodeAt(i - 1)] << ((i % 4) * 2);\r\n                const bits2 = reverseMap[base64Str.charCodeAt(i)] >>> (6 - (i % 4) * 2);\r\n                const bitsCombined = bits1 | bits2;\r\n                words[nBytes >>> 2] |= bitsCombined << (24 - (nBytes % 4) * 8);\r\n                nBytes++;\r\n            }\r\n        }\r\n        return new Word32Array(words, nBytes);\r\n    }\r\n};\r\n","import { Word32Array } from \"../Word32Array\";\r\nexport const Hex = {\r\n    /**\r\n     * Converts a word array to a hex string.\r\n     *\r\n     * @param {Word32Array} w An array of 32-bit words.\r\n     * @return {string} The hex string.\r\n     * @example\r\n     *   var hexString = Hex.stringify(new Word32Array([0x293892], 6));\r\n     */\r\n    stringify(w) {\r\n        const nSig = w.nSigBytes;\r\n        const words = w.words;\r\n        const hexChars = [];\r\n        for (let i = 0; i < nSig; i++) {\r\n            const byte = (words[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff;\r\n            hexChars.push((byte >>> 4).toString(16));\r\n            hexChars.push((byte & 0x0f).toString(16));\r\n        }\r\n        return hexChars.join(\"\");\r\n    },\r\n    /**\r\n     * Converts a hex string to a word array.\r\n     *\r\n     * @param {string} hexStr The hex string.\r\n     * @return {Word32Array} The word array.\r\n     * @example\r\n     *   var wordArray = Hex.parse(hexString);\r\n     */\r\n    parse(hexStr) {\r\n        const Len = hexStr.length;\r\n        const words = [];\r\n        for (let i = 0; i < Len; i += 2) {\r\n            words[i >>> 3] |= parseInt(hexStr.substr(i, 2), 16) << (24 - (i % 8) * 4);\r\n        }\r\n        return new Word32Array(words, Len / 2);\r\n    }\r\n};\r\n","import { Word32Array } from \"../Word32Array\";\r\nexport const Latin1 = {\r\n    /**\r\n     * Converts a word array to a Latin1 string.\r\n     *\r\n     * @param {Word32Array} w An array of 32-bit words.\r\n     * @return {string} The Latin1 string.\r\n     * @example\r\n     *   var latin1String = Latin1.stringify(new Word32Array([0x293892], 6));\r\n     */\r\n    stringify(w) {\r\n        const nSig = w.nSigBytes;\r\n        const words = w.words;\r\n        const latin1Chars = [];\r\n        for (let i = 0; i < nSig; i++) {\r\n            const byte = (words[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff;\r\n            latin1Chars.push(String.fromCharCode(byte));\r\n        }\r\n        return latin1Chars.join(\"\");\r\n    },\r\n    /**\r\n     * Converts a latin1 string to a word array.\r\n     *\r\n     * @param {string} latin1Str The latin1 string.\r\n     * @return {Word32Array} The word array.\r\n     * @example\r\n     *   var wordArray = Latin1.parse(latin1Str);\r\n     */\r\n    parse(latin1Str) {\r\n        const Len = latin1Str.length;\r\n        const words = [];\r\n        for (let i = 0; i < Len; i++) {\r\n            words[i >>> 2] |= (latin1Str.charCodeAt(i) & 0xff) << (24 - (i % 4) * 8);\r\n        }\r\n        return new Word32Array(words, Len);\r\n    }\r\n};\r\n","import { Latin1 } from \"./Latin1\";\r\nexport const Utf8 = {\r\n    /**\r\n     * Converts a word array to a UTF-8 string.\r\n     *\r\n     * @param {Word32Array} w An array of 32-bit words.\r\n     * @return {string} The UTF-8 string.\r\n     * @example\r\n     *   var utf8String = Utf8.stringify(new Word32Array([0x293892]));\r\n     */\r\n    stringify(w) {\r\n        try {\r\n            return decodeURIComponent(escape(Latin1.stringify(w)));\r\n        }\r\n        catch (e) {\r\n            throw new Error(\"Malformed UTF-8 data\");\r\n        }\r\n    },\r\n    /**\r\n     * Converts a UTF-8 string to a word array.\r\n     *\r\n     * @param {string} utf8Str The UTF-8 string.\r\n     * @return {Word32Array} The word array.\r\n     * @example\r\n     *   var wordArray = Utf8.parse(utf8Str);\r\n     */\r\n    parse(utf8Str) {\r\n        return Latin1.parse(unescape(encodeURIComponent(utf8Str)));\r\n    }\r\n};\r\n","function makeRandFunction() {\r\n    if (typeof window !== \"undefined\") {\r\n        const c = window.crypto || window.msCrypto;\r\n        if (!c) {\r\n            throw new Error(\"Crypto module not found\");\r\n        }\r\n        return function rand() {\r\n            return c.getRandomValues(new Uint32Array(1))[0];\r\n        };\r\n    }\r\n    else if (typeof global !== \"undefined\" && global.crypto) {\r\n        return function rand() {\r\n            return global.crypto.randomBytes(4).readInt32LE();\r\n        };\r\n    }\r\n    else if (typeof require === \"function\") {\r\n        return function rand() {\r\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\r\n            // @ts-ignore\r\n            return __non_webpack_require__(\"crypto\").randomBytes(4).readInt32LE();\r\n        };\r\n    }\r\n    throw new Error(\"Unable to find crypto module\");\r\n}\r\nexport const random = makeRandFunction();\r\n"],"sourceRoot":""}